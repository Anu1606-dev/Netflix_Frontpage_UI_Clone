"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[33656,23057,92801],{645570:(e,t,i)=>{i.r(t),i.d(t,{default:()=>l});let s={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ActivityAvatar_user",selections:[{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"firstName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageMediumUrl",storageKey:null}],type:"User",abstractKey:null};s.hash="abf151ba4d389a02e4541aa5f969d468";let l=s},339e3:(e,t,i)=>{var s,l;i.r(t),i.d(t,{default:()=>n});let o={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"AggregatedCommentListUnified_pin",selections:[{alias:null,args:null,concreteType:"AggregatedPinData",kind:"LinkedField",name:"aggregatedPinData",plural:!1,selections:l=[s={alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null}],storageKey:null},s,{alias:null,args:null,kind:"ScalarField",name:"highlightedAggregatedComments",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"pinner",plural:!1,selections:l,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"storyPinDataId",storageKey:null}],type:"Pin",abstractKey:null};o.hash="ba6cb3d83648d5a9f07e044db4a9cf58";let n=o},221354:(e,t,i)=>{let s;i.d(t,{Z:()=>l}),void 0===s&&(s=i.g);let l={setTimeout:(e,t)=>s.setTimeout(e,t),clearTimeout:e=>s.clearTimeout(e),setInterval:(e,t)=>s.setInterval(e,t),clearInterval:e=>s.clearInterval(e)}},191315:(e,t,i)=>{i.d(t,{Z:()=>d}),i(167912);var s,l=i(883119),o=i(559028),n=i(47848),a=i(785893);let r=void 0!==s?s:s=i(645570);function d({userKey:e,size:t="md",hasOutline:i}){let s=(0,n.Z)(r,e);if(!s)return null;let d=s.firstName,c=s.imageMediumUrl,h=s.username??"";return(0,a.jsx)(l.Tg,{href:`/${h}/`,rounding:"circle",children:(0,a.jsx)(o.qE,{name:d||h||"",outline:i,size:t,src:c??""})})}},178834:(e,t,i)=>{i.d(t,{Z:()=>c});var s=i(667294),l=i(883119),o=i(989820),n=i(144326),a=i(272109),r=i(167210),d=i(785893);let c=({handleBlockUser:e=null,handleClickReport:t=null,handleDelete:i=null,handleOnEdit:c=null,handleRemoveMention:h=null,handleHighlight:u,handleRemoveHighlight:_,showHighlightEducator:p,iconColor:m,small:g})=>{let x=(0,n.ZP)(),[f,y]=(0,s.useState)(!1),j=(0,s.useRef)(null),v=e=>{let t=(e||{}).event||{};t.preventDefault&&(t.preventDefault(),t.stopPropagation()),y(!f)};if(!(e||t||i||c||h||u))return null;let b={highlight:x.bt("Highlight", "Highlight", "Highlight a community post or comment", undefined, true),remove:x.bt("Remove highlight", "Remove highlight", "Remove highlight for a community post or comment", undefined, true),edit:x.bt("Edit", "Edit", "Edit a community post or comment", undefined, true),delete:x.bt("Delete", "Delete", "Delete a community post or comment", undefined, true),report:x.bt("Report this content", "Report this content", "Report a community post or comment", undefined, true),removeMention:x.bt("Remove @mention", "Remove @mention", "closeup.activityItem.removeMention", undefined, true),blockUser:x.bt("Block user", "Block user", "closeup.activityItem.blockUser", undefined, true)};return(0,d.jsxs)(l.kC,{alignItems:"end",direction:"column",justifyContent:"start",children:[(0,d.jsx)(l.xu,{"data-test-id":"flyout-toggle",children:(0,d.jsx)(l.hU,{ref:j,accessibilityExpanded:f,accessibilityHaspopup:!0,accessibilityLabel:x.bt("more options", "more options", "accessible label for button to see more options on report content", undefined, true),icon:"ellipsis",iconColor:m||"gray",onClick:v,size:g?"sm":"md"})}),p&&(0,d.jsx)(l.mh,{zIndex:r.lI,children:(0,d.jsx)(a.Z,{children:(0,d.jsx)(o.Qp,{anchor:j.current,experienceIds:[503461],idealDirection:"down",placementId:12,positionRelativeToAnchor:!1,showCaret:!0,textAlign:"center"})})}),f&&(0,d.jsxs)(l.Lt,{anchor:j.current,disableMobileUI:!0,id:"dropdown-flyout",idealDirection:"down",onDismiss:v,children:[u&&(0,d.jsx)(l.Lt.Item,{dataTestId:"dropdown-item-highlight",onSelect:()=>{u(),v()},option:{label:b.highlight,value:b.highlight}}),_&&(0,d.jsx)(l.Lt.Item,{dataTestId:"dropdown-item-removeHighlight",onSelect:()=>{_(),v()},option:{label:b.remove,value:b.remove}}),c&&(0,d.jsx)(l.Lt.Item,{dataTestId:"dropdown-item-edit",onSelect:()=>c(),option:{label:b.edit,value:b.edit}}),i&&(0,d.jsx)(l.Lt.Item,{dataTestId:"dropdown-item-delete",onSelect:()=>i(),option:{label:b.delete,value:b.delete}}),t&&(0,d.jsx)(l.Lt.Item,{dataTestId:"dropdown-item-report",onSelect:()=>t(),option:{label:b.report,value:b.report}}),h&&(0,d.jsx)(l.Lt.Item,{dataTestId:"dropdown-item-removeMention",onSelect:()=>{h(),v()},option:{label:b.removeMention,value:b.removeMention}}),e&&(0,d.jsx)(l.Lt.Item,{dataTestId:"dropdown-item-blockUser",onSelect:()=>e(),option:{label:b.blockUser,value:b.blockUser}})]})]})}},827872:(e,t,i)=>{i.d(t,{Z:()=>u});var s=i(667294),l=i(883119),o=i(310038),n=i(721748),a=i(501989),r=i(144326),d=i(785893);function c(e,t,i){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?s:String(s))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class h extends s.PureComponent{constructor(...e){super(...e),c(this,"state",{truncate:!!this.props.text&&this.props.text.length>(this.props.maxCharLength||o.lr)+this.revealText.length}),c(this,"showFullText",()=>this.setState({truncate:!1}))}get revealText(){return this.props.inUnifiedComments?this.props.i18n.bt("...more", "... More", "click to see more of a long post", undefined, true):this.props.i18n.bt("... See more", "... See more", "click to see more of a long post", undefined, true)}render(){let{allowReveal:e,maxCharLength:t,size:i,tags:r,taggedUsers:c,text:h}=this.props,{truncate:u}=this.state,_=u?h.substring(0,t||o.lr).trim():h;return(0,d.jsxs)(s.Fragment,{children:[(0,d.jsx)(a.Z,{shouldShowFirstNameOnly:!0,taggedUsers:c,tags:r,text:_}),u&&!e&&(0,d.jsx)(l.xv,{inline:!0,overflow:"normal",weight:"bold",children:this.revealText}),u&&e&&(0,d.jsx)(n.Z,{color:"default",handleClick:this.showFullText,size:i,text:this.revealText})]})}}c(h,"defaultProps",{allowReveal:!1,size:"200",tags:[],taggedUsers:[],text:""});let u=function(e){let t=(0,r.ZP)();return(0,d.jsx)(h,{...e,i18n:t})}},721748:(e,t,i)=>{i.d(t,{Z:()=>o});var s=i(883119),l=i(785893);function o({color:e="subtle",handleClick:t,size:i="100",text:o}){return(0,l.jsx)(s.xu,{display:"inlineBlock",children:(0,l.jsx)(s.iP,{onTap:t,rounding:"pill",children:(0,l.jsx)(s.xv,{color:e,size:i,weight:"bold",children:o})})})}},310038:(e,t,i)=>{i.d(t,{A7:()=>l,YD:()=>o,lr:()=>s});let s=170,l=(e,t,i)=>{let s=new Date(e);return 60>Math.floor((new Date().getTime()-s.getTime())/1e3)?t.bt("now", "now", "timestamp for a comment or post that was created within the last minute", undefined, true):i(e,!0)},o=e=>{let t=e.first_name||e.full_name||e.username;return t&&t.length>60?t.substring(0,60).trim().concat("..."):t}},255590:(e,t,i)=>{i.d(t,{Z:()=>h});var s=i(545007),l=i(252071),o=i(642593),n=i(625987),a=i(642758),r=i(701842),d=i(378041),c=i(403764);function h(){let e=(0,s.I0)(),{aggregatedCommentDeleted:t,updateCommentCount:i}=(0,n.nf)();return async({aggregatedCommentId:s,aggregatedPinId:n,feedType:h,orbacSubjectId:u,parentId:_,type:p,updateParentCommentCount:m,pinId:g})=>{await l.Z.create("AggregatedCommentResource",{commentId:s,...u?{orbacSubjectId:u}:{}}).callDelete({showError:!1}),_&&(e((0,r.EX)({feedId:n||_,feedType:h||c.Z.AGGREGATED_COMMENTS,itemIds:[s],itemType:"aggregatedcomment"})),t(_,s),m&&(p||0===p)&&(p===o.Rv.TOP&&g?e((0,d.R)(g,-1)):p===o.Rv.REPLY_TO_AGGREGATED?i(_,-1):e((0,a.L8)(_,-1))))}}},194054:(e,t,i)=>{i.d(t,{Z:()=>ee});var s=i(667294),l=i(883119),o=i(112467),n=i(545007),a=i(14890),r=i(609399),d=i(573706),c=i(395141),h=i(252071),u=i(60598),_=i(876594),p=i(144326),m=i(512541),g=i(191851),x=i(785893);function f(e,t,i){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?s:String(s))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let y=`
.uploadProgressBar {
  background-color: ${_.x_d};
  border-radius: 8px;
  height: 16px;
  opacity: 1;
  position: absolute;
  transition: opacity 85ms ease-in, width 85ms ease-in;
  z-index: 10;

  &.transition {
    opacity: 0;
    transition: opacity 85ms ease-in, width 85ms ease-in;
  }
}
`;class j extends s.Component{constructor(...e){super(...e),f(this,"_videoContainerRef",null),f(this,"removeVideoTag",()=>{this._videoContainerRef&&this._videoContainerRef.childNodes[0]&&this._videoContainerRef.removeChild(this._videoContainerRef.childNodes[0])}),f(this,"clear",({event:e})=>{e.stopPropagation(),this.removeVideoTag(),this.props.handleRemoveClick()})}get isPin(){let{display:e,imagePreviewSrc:t,videoUrls:i}=this.props;return"pin"===e&&(!!t||!!i)}renderProgressBar(){let{progress:e}=this.props;return(0,x.jsx)("div",{className:100===e||0===e?"uploadProgressBar transition":"uploadProgressBar",style:{width:`${e}%`}})}renderDropZone(){return(0,x.jsxs)(l.xu,{children:[(0,x.jsx)(l.kC,{alignItems:"center",justifyContent:"center",children:(0,x.jsx)(l.kC,{alignItems:"center",justifyContent:"center",children:(0,x.jsx)(l.JO,{accessibilityLabel:this.props.i18n.bt("Add a photo", "Add a Photo", "Add a photo as part of a form", undefined, true),color:"default",icon:"camera",size:32})})}),(0,x.jsx)(l.xu,{marginTop:2,paddingX:12,children:(0,x.jsx)(l.xv,{align:"center",color:"default",weight:"bold",children:this.props.i18n.bt("Drag and drop or click to upload", "Drag and drop or click to upload", "Label on drag/drop area for uploading a pin", undefined, true)})})]})}renderImage(){let{height:e,imagePreviewSrc:t,width:i}=this.props,s=this.props.i18n.bt("Your upload", "Your Upload", "Image a pinner just uploaded to a form", undefined, true);return this.isPin?(0,x.jsx)("img",{alt:s,src:t}):(0,x.jsx)(l.xu,{height:e,width:i,children:(0,x.jsx)(l.Ee,{alt:s,color:"white",naturalHeight:e,naturalWidth:i,src:t})})}renderResetButton(){return(0,x.jsx)(l.xu,{left:!0,margin:2,position:"absolute",top:!0,children:(0,x.jsx)(l.hU,{accessibilityLabel:this.props.i18n.bt("Remove photo", "Remove Photo", "Remove photo from a form", undefined, true),bgColor:"lightGray",icon:"clear",iconColor:"darkGray",onClick:this.clear,size:"sm"})})}renderContent(){let{height:e,imagePreviewSrc:t,isHovering:i,isVideo:o,isVideoComplete:n,isOver:a,thumbnail:r,videoUrls:d,allowReset:c=!0,width:h}=this.props,u=d?(0,x.jsx)("video",{autoPlay:!0,controls:!0,height:this.isPin?"auto":e,loop:!0,poster:r||"",width:h,children:Object.keys(d).map(e=>(0,x.jsx)("source",{src:d[e],type:"hls"===e?"m3u8":"video/mp4"},e))}):null;return(0,x.jsxs)(s.Fragment,{children:[(0,x.jsx)(l.zd,{height:"100%",rounding:2,children:(0,x.jsxs)(l.xu,{alignItems:"center",color:a?"secondary":"default",display:"flex",height:"100%",justifyContent:"center",width:"100%",children:[!t&&!o&&this.renderDropZone(),o&&!d&&(0,x.jsxs)(l.xu,{children:[n&&(0,x.jsx)(l.xv,{align:"center",weight:"bold",children:this.props.i18n.bt("Processing video", "Processing Video", "Loading message shown while user video is uploading", undefined, true)}),(0,x.jsx)(l.xu,{paddingY:4,children:(0,x.jsx)(l.$j,{accessibilityLabel:this.props.i18n.bt("Video being uploaded", "Video uploading", "Loading spinner while video uploads", undefined, true),show:!0})})]}),u,t&&this.renderImage()]})}),(t||d)&&c&&i&&this.renderResetButton()]})}render(){let{connectDropTarget:e,height:t,imagePreviewSrc:i,onClick:s,videoUrls:o,width:n,hoverHandlers:{onMouseOver:a,onMouseLeave:r}}=this.props,d=this.isPin?"auto":t,c=(0,x.jsxs)(l.xu,{position:"relative",children:[(0,x.jsx)(m.Z,{unsafeCSS:y}),this.renderProgressBar(),i||o?(0,x.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:{border:this.isPin?0:"2px dashed #767676",borderRadius:"10px",outline:"none"}},height:d,marginEnd:"auto",marginStart:"auto",padding:0,width:n,children:(0,x.jsx)(l.iP,{fullWidth:!1,mouseCursor:i?"default":"pointer",onMouseEnter:a,onMouseLeave:r,children:this.renderContent()})}):(0,x.jsx)("button",{onClick:s,onMouseEnter:a,onMouseLeave:r,style:{width:n,border:this.isPin?0:"2px dashed #767676",borderRadius:"10px",cursor:i?"default":"pointer",height:d,marginLeft:"auto",marginRight:"auto",outline:"none",padding:0},children:this.renderContent()})]});return e((0,x.jsx)("div",{children:c}))}}let v=(0,u.GR)(e=>e.accepts,{drop:(e,t)=>{e.onDrop&&e.onDrop(e,t)}},(e,t)=>({connectDropTarget:e.dropTarget(),isOver:t.isOver(),canDrop:t.canDrop()}))(function(e){let t=(0,p.ZP)(),{isHovering:i,hoverHandlers:s}=(0,g.Z)();return(0,x.jsx)(j,{...e,hoverHandlers:s,i18n:t,isHovering:i})});var b=i(400416),P=i(730212);function C(e,t,i){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?s:String(s))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let w=["video/quicktime","video/mp4"],A=e=>e>=200&&e<400,z=(e,t="1200x")=>e&&`https://i.pinimg.com/${t}/${e.substring(0,2)}/${e.substring(2,4)}/${e.substring(4,6)}/${e}.jpg`||"";class S extends s.Component{constructor(...e){super(...e),C(this,"state",{imagePreviewSrc:this.props.existingImageSrc||"",isVideo:!1,isVideoComplete:!1,thumbnail:null,videoUrls:null,errorFlyout:null,progress:0}),C(this,"mounted",!1),C(this,"containerRef",null),C(this,"fileInputRef",null),C(this,"xhr",null),C(this,"CHECK_VIDEO_TIMEOUT",null),C(this,"ERROR_MESSAGE",this.props.i18n.bt("Unable to upload video. Please try again later.", "Unable to upload video. Please try again later.", "Error shown when we can't accept video uploads", undefined, true)),C(this,"handleFileDrop",(e,t)=>{if(t&&(!this.xhr||4===this.xhr.readyState)){let e=t.getItem().files[0];this.handleFile(e)}}),C(this,"handleFile",e=>{let{onImageUploadStart:t}=this.props;e.size>2e9?this.showError(this.props.i18n.bt("The video is too large. The maximum size is 2 GB.", "The video is too large. The maximum size is 2 GB.", "Error if a user tries to upload a video that is too large", undefined, true)):(this.props.allowVideo&&w.includes(e.type)&&this.setState({isVideo:!0}),this.loadMedia(e),t&&t())}),C(this,"showError",e=>{let t=(0,x.jsx)(l.J2,{anchor:this.containerRef,idealDirection:this.props.idealErrorDirection,onDismiss:()=>this.setState({errorFlyout:null}),shouldFocus:!1,size:"sm",children:(0,x.jsx)(l.xu,{padding:3,children:(0,x.jsx)(l.qb,{title:e,type:"problem"})})});this.removePreview(t)}),C(this,"openFileDialog",()=>{this.state.imagePreviewSrc||this.state.isVideo||(this.props.logContextEvent({event_type:101,component:192,element:1156}),this.fileInputRef&&this.fileInputRef.click())}),C(this,"openFile",e=>{let t=e.target.files[0];this.handleFile(t)}),C(this,"removePreview",e=>{this.setState({imagePreviewSrc:"",progress:0,isVideo:!1,isVideoComplete:!1,videoUrls:null,errorFlyout:e}),this.fileInputRef&&(this.fileInputRef.value=""),this.xhr&&this.xhr.abort&&(this.xhr.abort(),this.xhr=null),this.CHECK_VIDEO_TIMEOUT&&clearTimeout(this.CHECK_VIDEO_TIMEOUT),this.props.onReset&&this.props.onReset()}),C(this,"checkForMedia",async e=>{let t=await h.Z.create("VIPResource",{upload_ids:[e]}).callGet();if(t.resource_response&&t.resource_response.data&&t.resource_response.data[e]){let{status:i,signature:s}=t.resource_response.data[e];"processing"===i||"registered"===i?this.CHECK_VIDEO_TIMEOUT=setTimeout(()=>this.checkForMedia(e),1e3):"succeeded"===i?this.handleMediaUploadSuccess(s,e):this.showError(this.ERROR_MESSAGE)}else this.showError(this.ERROR_MESSAGE)}),C(this,"loadMedia",e=>{let{isVideo:t}=this.state;h.Z.create("VIPResource",{type:t?"video":"triedit-image"}).callCreate().then(t=>{let{upload_id:i,upload_url:s,upload_parameters:l}=t.resource_response.data??{};this.uploadMedia(e,i,s,l)},()=>{this.showError(this.ERROR_MESSAGE)})}),C(this,"uploadMedia",(e,t,i,s)=>{let{isVideo:l}=this.state,o=new XMLHttpRequest;o.open("POST",i,!0),o.onload=()=>{A(o.status)?this.setState({errorFlyout:null,isVideoComplete:l}):this.showError(this.props.i18n.bt("Something went wrong. Please try again later.", "Something went wrong. Please try again later.", "Error if video fails to upload", undefined, true)),this.checkForMedia(t)},o.upload.onprogress=e=>{let t=Math.round(99*e.loaded/e.total);this.setState({progress:t})};let n=new FormData;for(let e in s)n.append(e,s[e]);n.append("file",e),o.send(n),this.xhr=o})}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}async handleMediaUploadSuccess(e,t){let{isVideo:i}=this.state,{width:s,height:l}=this.props;if(i){if(!this.props.isAuthenticated){this.showError(this.ERROR_MESSAGE);return}let i=await (0,b.Z)({url:"/v3/videos/urls/",data:{signatures:[e]}});this.handleVideoUploadSuccess(i,e,t)}else{let t=z(e);this.setState({imagePreviewSrc:t,progress:100}),this.props.onImageUploadFinished({image:{url:t,width:s,height:l}})}}handleVideoUploadSuccess(e,t,i){if(!this.mounted)return;let{data:s}=e.resource_response,l=`https://i.pinimg.com/${s[t].metadata.thumbnail}`,o=s[t].urls;this.setState({videoUrls:o,thumbnail:l,progress:100});let n=new XMLHttpRequest;n.onload=()=>{let e=new FileReader;e.readAsDataURL(n.response),e.onloadend=()=>{this.props.onImageUploadFinished({video:{uploadId:i,imageBase64:e.result??""}})}},n.open("GET",l),n.responseType="blob",n.send()}render(){let{FILE:e}=c.NativeTypes,{errorFlyout:t,imagePreviewSrc:i,isVideo:s,isVideoComplete:o,progress:n,thumbnail:a,videoUrls:r}=this.state,{allowReset:d,allowVideo:h,display:u,height:_,width:p}=this.props;return(0,x.jsxs)(l.xu,{ref:e=>{this.containerRef=e},children:[(0,x.jsx)(l.xu,{display:"visuallyHidden",children:(0,x.jsx)("input",{ref:e=>{this.fileInputRef=e},accept:h?"image/*,video/mp4,video/quicktime":"image/*",onChange:this.openFile,type:"file"})}),(0,x.jsx)(v,{accepts:[e],allowReset:d,display:u,handleRemoveClick:this.removePreview,height:_,imagePreviewSrc:i,isVideo:s,isVideoComplete:o,onClick:this.openFileDialog,onDrop:this.handleFileDrop,progress:n,thumbnail:a,videoUrls:r,width:p}),t]})}}C(S,"defaultProps",{onImageUploadStart:()=>{}});let k=function(e){let{logContextEvent:t}=(0,d.v)(),{isAuthenticated:i}=(0,P.B)(),s=(0,p.ZP)();return(0,x.jsx)(S,{...e,i18n:s,isAuthenticated:i,logContextEvent:t})};var I=i(517159),T=i(476198),D=i(901450),E=i(642758),M=i(686993);function R(e,t,i){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?s:String(s))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let L=/#[^(. #,\/$%\^&\*;:{}=\`~()\[\]@|<>)]*$/;class Z extends s.PureComponent{constructor(e){super(e),R(this,"setTextAreaRef",e=>{this._textAreaRef=e}),R(this,"handleTextInputChange",({value:e})=>{this.setState({notes:e.substring(0,1e3)}),e.length>1e3?this.forceUpdate():this.handleHashtagTypeahead(e)}),R(this,"handleHashtagTypeahead",e=>{let t=L.exec(e),i=t?t[0]:"";!this.state.inTypeahead&&i?this.setState({inTypeahead:!0,typeaheadValue:i}):this.state.inTypeahead&&(i?this.setState({typeaheadValue:i}):this.setState({inTypeahead:!1,typeaheadValue:""}))}),R(this,"addHashtag",e=>{this.setState(t=>({inTypeahead:!1,notes:t.notes.replace(L,e),typeaheadValue:""}))}),R(this,"uploadImageAndCreateDidIt",()=>{(0,b.Z)({url:"/v3/did_it/image/upload/",method:"PUT",data:{image_url:this.state.imageUrlToSend}}).then(e=>{let{data:{image_signature:t}}=e.resource_response;return this.createUpdateDidIt(t)}).catch(()=>this.createUpdateDidIt())}),R(this,"handleImageReset",()=>this.setState({imageUrlToSend:null})),R(this,"handleFinishImageUpload",e=>{e.image&&this.setState({imageUrlToSend:e.image.url})}),R(this,"handleDoneClick",()=>{let{pinId:e,logContextEvent:t}=this.props;t({event_type:101,view_type:101,component:192,element:1112,object_id_str:e}),this.setState({submitted:!0}),this.handleDoneSubmission()}),R(this,"handleDoneSubmission",()=>{let{imageUrlToSend:e}=this.state,{pinActivity:t}=this.props;if(e){if(!t||e!==t.oldImageUrl)return this.uploadImageAndCreateDidIt();if(t.imageSignatures&&t.imageSignatures.length>0)return this.createUpdateDidIt(t.imageSignatures[0])}return this.createUpdateDidIt()}),R(this,"handleCancel",()=>{let{onDoneStateChanged:e}=this.props;e&&e(!1)}),R(this,"handleDeleteConfirmation",e=>{let{aggregatedPinDataId:t,deleteUserDidItData:i,isDoneByMe:s,loggedInUser:{username:l},onDoneStateChanged:o,pinId:n,logContextEvent:a}=this.props;this.setState({showDeleteModal:!1}),e&&(a({event_type:101,view_type:101,component:192,element:1264,object_id_str:n}),i({aggregatedPinDataId:t,pinId:n,username:l,id:e,isOwnedByMe:!0}),o&&o(s))}),R(this,"handleShowDeleteModal",()=>this.setState({showDeleteModal:!0}));let t=e.pinActivity||{};this.state={id:t.id||null,imageUrlToSend:t.oldImageUrl||null,inTypeahead:!1,notes:t.notes||"",showDeleteModal:!1,submitted:!1,typeaheadValue:""}}createUpdateDidIt(e){let{aggregatedPinDataId:t,createUserDidItData:i,isDoneByMe:s,loggedInUser:{username:l},onDoneStateChanged:o,pinId:n,toastManagerContext:a,updateUserDidItData:r}=this.props,{id:d,notes:c}=this.state;c&&(s?d&&r({id:d,pinId:n,details:c,image_signatures:e?[e]:[]}):i({aggregatedPinDataId:t,username:l,details:c,image_signatures:e?[e]:[],pin_id:n}),o&&o(!s),-1===window.location.href.indexOf(l+"/tried")&&a.showToast(({hideToast:e})=>(0,x.jsx)(T.ZP,{duration:3e3,href:`/${l}/tried/`,onHide:e,text:this.props.i18n.bt("Nicely done! Pins you've tried live on your profile", "Nice work! Pins you've tried live on your profile", "Congratulations after trying a pin", undefined, true)})))}render(){let{imageUrlToSend:e,notes:t,showDeleteModal:i,submitted:s}=this.state,{isDoneByMe:o,pinActivity:n}=this.props,a=!!e&&(n||{}).oldImageUrl!==e,d=!!e,c=n&&n.notes!==t,h=!!t&&""!==t.trim();return(0,x.jsxs)(l.xu,{children:[(0,x.jsx)(l.xu,{marginTop:4,paddingX:12,children:(0,x.jsx)(l.xu,{column:12,children:(0,x.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:{transition:"padding-top 0.2s ease"}},paddingY:e?0:10,children:(0,x.jsx)(l.xu,{alignItems:"center",color:"transparent",column:12,display:"flex",justifyContent:"center",marginBottom:2,rounding:2,children:(0,x.jsx)(k,{display:"image",existingImageSrc:e,height:366,idealErrorDirection:"up",onImageUploadFinished:this.handleFinishImageUpload,onReset:this.handleImageReset,width:366})})})})}),(0,x.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:{transition:"opacity 0.2s ease",transitionDelay:"0.2s",visibility:e?"visible":"hidden"}},height:e?"auto":0,opacity:e?1:0,children:(0,x.jsxs)(l.xu,{margin:3,marginEnd:"auto",marginStart:"auto",width:366,children:[(0,x.jsx)(l.xu,{ref:this.setTextAreaRef,children:(0,x.jsx)(l.Kx,{id:"trynotes",onChange:this.handleTextInputChange,placeholder:this.props.i18n.bt("Add a note or tip", "Add a note or tip", "Tip input for tried it", undefined, true),value:t})}),this.state.inTypeahead&&this._textAreaRef?(0,x.jsx)(M.Z,{addHashtag:this.addHashtag,anchor:this._textAreaRef,idealDirection:"up",query:this.state.typeaheadValue}):null,t.length>900&&(0,x.jsx)(l.xu,{paddingY:1,children:(0,x.jsxs)(l.xv,{align:"end",size:"200",children:[" ",t.length,"/",1e3," "]})})]})}),(0,x.jsxs)(l.kC,{alignItems:"stretch",justifyContent:"end",children:[i&&(0,x.jsx)(r.Z,{didItData:n,onDeleteConfirmation:this.handleDeleteConfirmation}),s?(0,x.jsx)(l.xu,{marginEnd:2,children:(0,x.jsx)(l.$j,{accessibilityLabel:this.props.i18n.bt("Submit", "submit", "accessible label for loading spinner on submit button", undefined, true),show:!0})}):null,(0,x.jsxs)(l.xu,{display:"flex",marginBottom:3,marginEnd:4,children:[o?(0,x.jsx)(l.xu,{marginEnd:1,children:(0,x.jsx)(l.zx,{onClick:this.handleShowDeleteModal,size:"md",text:this.props.i18n.bt("Delete", "Delete", "delete button in modal for tried-it info", undefined, true)})}):(0,x.jsx)(l.xu,{marginEnd:1,children:(0,x.jsx)(l.zx,{onClick:this.handleCancel,size:"md",text:this.props.i18n.bt("Cancel", "Cancel", "cancel button in modal for tried-it info", undefined, true)})}),(0,x.jsx)(l.xu,{children:(0,x.jsx)(l.zx,{color:"red",disabled:!d||!h||!c&&!a,onClick:this.handleDoneClick,size:"md",text:this.props.i18n.bt("Done", "Done", "done button in modal for tried-it info", undefined, true)})})]})]})]})}}let U=(0,I.Z)(function(e){let{logContextEvent:t}=(0,d.v)(),i=(0,p.ZP)(),s=(0,n.I0)(),l=(0,a.bindActionCreators)(E.DD,s),o=(0,a.bindActionCreators)(E.lg,s),r=(0,a.bindActionCreators)(E.IU,s);return(0,x.jsx)(Z,{...e,createUserDidItData:l,deleteUserDidItData:o,i18n:i,logContextEvent:t,toastManagerContext:(0,D.F9)(),updateUserDidItData:r})});var O=i(961754);class H extends s.Component{constructor(...e){var t,i,s;super(...e),t="onDoneStateChanged",i=e=>{let{onDoneStateChanged:t,pinActivityResource:i}=this.props;t&&t(e),e&&i&&i.refresh&&i.refresh()},(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?s:String(s))in this?Object.defineProperty(this,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):this[t]=i}render(){let{onDoneStateChanged:e,pinActivityResource:t,pinTitle:i,userDidItDataId:s,...n}=this.props;return!t||t&&t.isLoaded?(0,x.jsx)(l.xu,{rounding:2,children:(0,x.jsx)(U,{onDoneStateChanged:this.onDoneStateChanged,pinActivity:function(e){if(!e)return null;let{details:t,images:i,image_signatures:s,id:l}=e;return{id:l,imageSignatures:s,notes:t,oldImageUrl:i[0]["200x"].url}}(t&&t.data),...n})}):(0,x.jsx)(o.Z,{})}}function B(e){let t=(0,O.Z)({name:"DidItUserPinActivityResource",options:{aggregated_pin_data_id:e.aggregatedPinDataId,username:"me"},noCache:!0});return(0,x.jsx)(H,{...e,pinActivityResource:t})}function F(e){let t=(0,O.Z)({name:"DidItActivityResource",options:{user_did_it_data_id:e.userDidItDataId,username:"me"},noCache:!0});return(0,x.jsx)(H,{...e,pinActivityResource:t})}function N(e){return e.isDoneByMe&&e.userDidItDataId?(0,x.jsx)(F,{...e}):e.isDoneByMe?(0,x.jsx)(B,{...e}):(0,x.jsx)(H,{...e})}var V=i(758339),$=i(852045);let W=e=>{if(!e)return null;let{title:t}=e.richMetadata;return t?{...e,title:t}:null};var G=i(70494),Y=i(415384);class X extends s.PureComponent{render(){let{aggregatedPinDataId:e,isDoneByMe:t,loggedInUser:i,onDoneStateChanged:s,onHide:n,pinId:a,pinResource:r,pinTitle:d,userDidItDataId:c}=this.props;if(!r.isLoaded)return(0,x.jsx)(o.Z,{});let{title:h}=W((0,$.Z)((0,G.Z)({pin:r.data})))||{},u=d||h?(0,Y.Z)(this.props.i18n.bt("Add a photo of {{pinTitle}}", "Add a photo of {{pinTitle}}", "Adding photo of a pin", undefined, true),{pinTitle:d||h||""}):this.props.i18n.bt("Add a photo", "Add a photo", "Adding a photo", undefined, true);return(0,x.jsx)(V.ZP,{accessibilityModalLabel:u,heading:u,onDismiss:n,size:500,children:(0,x.jsx)(l.xu,{color:"default",display:"flex",justifyContent:"center",rounding:2,children:(0,x.jsx)(N,{aggregatedPinDataId:e,isDoneByMe:t,loggedInUser:i,onDoneStateChanged:s,pinId:a,pinTitle:d||h,userDidItDataId:c})})})}}function K(e){let t=(0,p.ZP)(),i=(0,O.Z)({name:"PinResource",options:{field_set_key:"detailed",id:e.pinId}});return(0,x.jsx)(X,{...e,i18n:t,pinResource:i})}var q=i(803611);function J(e,t,i){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?s:String(s))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class Q extends s.PureComponent{constructor(...e){super(...e),J(this,"state",{showModal:!1}),J(this,"onTriedItButtonClick",e=>{let{requireAuth:t,logContextEvent:i}=this.props;if(e&&e.stopPropagation(),t){t();return}this.handleModalStateChange(!0),i({event_type:101,view_type:101,component:this.props.thriftComponentType,element:1141,object_id_str:this.props.pinId,aux_data:{is_create:!this.props.isDoneByMe}})}),J(this,"handleHideModal",()=>{this.handleModalStateChange(!1),this.props.logContextEvent({event_type:101,view_type:101,component:192,element:75,object_id_str:this.props.pinId})}),J(this,"onModalDoneStateChanged",e=>{this.handleModalStateChange(!1,e)}),J(this,"handleModalStateChange",(e,t)=>{let{onDoneStateChanged:i,onToggleModal:s}=this.props;this.setState({showModal:e},()=>{!e&&i&&i("boolean"==typeof t&&t),s&&s(e)})})}render(){let{aggregatedPinDataId:e="",isDoneByMe:t=!1,loggedInUser:i={id:"",username:""},pinId:l="",pinTitle:o,userDidItDataId:n}=this.props;return(0,x.jsxs)(s.Fragment,{children:[this.props.children({onTriedItButtonClick:this.onTriedItButtonClick}),this.state.showModal?(0,x.jsx)(K,{aggregatedPinDataId:e,isDoneByMe:t,loggedInUser:i,onDoneStateChanged:this.onModalDoneStateChanged,onHide:this.handleHideModal,pinId:l,pinTitle:o??"",userDidItDataId:n}):null]})}}function ee(e){let{logContextEvent:t}=(0,d.v)(),i=(0,q.Z)();return(0,x.jsx)(Q,{...e,logContextEvent:t,requireAuth:i})}},609399:(e,t,i)=>{i.d(t,{Z:()=>a});var s=i(883119),l=i(758339),o=i(144326),n=i(785893);function a({onDeleteConfirmation:e,didItData:t}){let i=(0,o.ZP)(),a=t&&t.id,r=i.bt("Are you sure?", "Are you sure?", "Confirmation dialog for deleting data", undefined, true);return(0,n.jsx)(l.ZP,{accessibilityModalLabel:i.bt("Are you sure you want to delete the did it photo?", "Are you sure you want to delete the did it photo?", "Label for a modal showing to confirm deleting a did it photo", undefined, true),footer:(0,n.jsxs)(s.xu,{display:"flex",justifyContent:"end",marginEnd:-1,marginStart:-1,children:[(0,n.jsx)(s.xu,{padding:1,children:(0,n.jsx)(s.zx,{fullWidth:!0,onClick:()=>e(null),size:"lg",text:i.bt("Cancel", "Cancel", "Cancel the deleting data in a modal form", undefined, true)})}),(0,n.jsx)(s.xu,{padding:1,children:(0,n.jsx)(s.zx,{color:"red",dataTestId:"delete-did-it-button",fullWidth:!0,onClick:()=>{e(a)},size:"lg",text:i.bt("Delete", "Delete", "Confirmation of deleting data", undefined, true)})})]}),heading:r,onDismiss:()=>e(null),role:"alertdialog",size:"sm",children:(0,n.jsx)(s.xu,{paddingX:4,paddingY:2,children:(0,n.jsx)(s.xv,{children:i.bt("This will remove this photo", "This will remove this photo", "Confirmation dialog for deleting data", undefined, true)})})})}},112467:(e,t,i)=>{i.d(t,{Z:()=>n});var s=i(883119),l=i(144326),o=i(785893);function n(){let e=(0,l.ZP)();return(0,o.jsx)(s.xu,{alignItems:"center",color:"default",dangerouslySetInlineStyle:{__style:{outline:"none"}},display:"flex",height:155,justifyContent:"center",rounding:2,width:300,children:(0,o.jsx)(s.$j,{accessibilityLabel:e.bt("Tried it", "Tried it", " - ", undefined, true),show:!0})})}},182922:(e,t,i)=>{i.d(t,{Z:()=>eM});var s,l=i(667294),o=i(545007),n=i(14890),a=i(883119),r=i(545230),d=i(785893);let c="__SafeLinkFlag__",h=({html:e,onClick:t})=>{let i=t||null,s=[],l=(e=(e=e||"").replace(/#[^(\-\\.\s#,\/$%\^&\*;:{}=\`~()\[\]@|<>)]+/gi,e=>(s.push({url:`/search/pins/?q=${encodeURIComponent(e)}&rs=${r.i.HASHTAG_CLOSEUP}`,text:e}),c))).replace(/<a[\s]+href=['"]([^'"<>]+)['"][^>]*>([^<]*)<\/a>/gi,(e,t,i)=>(s.push({url:t,text:i}),c));return(0,d.jsx)(a.xu,{"data-test-id":"safe-link",children:l.split(RegExp(`(${c})`)).filter(e=>e.length>0).map((e,t)=>{let l=e;if(e===c&&s.length){let{url:e,text:t}=s.shift();l=(0,d.jsx)(a.rU,{display:"inlineBlock",href:e,onClick:i||void 0,underline:"hover",children:t})}return(0,d.jsx)(a.xv,{color:"shopping",inline:!0,weight:"bold",children:l},t)})})};i(167912);var u=i(616550),_=i(191315),p=i(758339);let m=({accessibilityModalLabel:e,cancelButtonText:t,confirmButtonText:i,detail:s,heading:l,onConfirm:o,onDismiss:n})=>(0,d.jsx)(p.ZP,{accessibilityModalLabel:e,heading:l,onDismiss:n,size:"md",children:(0,d.jsxs)(a.xu,{children:[(0,d.jsx)(a.xu,{padding:4,children:(0,d.jsx)(a.xv,{children:s})}),(0,d.jsxs)(a.kC,{alignItems:"stretch",justifyContent:"end",children:[(0,d.jsx)(a.xu,{margin:2,children:(0,d.jsx)(a.xu,{"data-test-id":"confirm-modal-cancel",children:(0,d.jsx)(a.zx,{fullWidth:!0,onClick:n,text:t})})}),(0,d.jsx)(a.xu,{margin:2,children:(0,d.jsx)(a.xu,{"data-test-id":"confirm-modal-confirm",children:(0,d.jsx)(a.zx,{color:"red",fullWidth:!0,onClick:()=>{o(),n()},text:i})})})]})]})});var g=i(397398),x=i(573706),f=i(517159),y=i(144326),j=i(383399),v=i(733383),b=i(332290),P=i(43688);function C(e,t,i){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?s:String(s))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let w={isTextChanged:!1,showConfirmDiscardModal:!1,submissionInProgress:!1,textValue:"",userMentionOverLimitError:!1};class A extends l.Component{constructor(...e){super(...e),C(this,"state",{...w,tags:this.props.tags||[],textValue:this.props.text||"",isEmojiTrayOpen:!1}),C(this,"handleFocus",()=>{this.props.onEnter()}),C(this,"handleChange",({text:e,mentions:t})=>{t.length<this.state.tags.length&&this.props.logContextEvent({event_type:8906,aux_data:{tag_type:1}});let i=this.props.text||"";this.setState({isTextChanged:i!==e,textValue:e,tags:t,userMentionOverLimitError:t.length>5})}),C(this,"handleOnClickEdit",()=>{let{onEditItem:e}=this.props,t={},{textValue:i,tags:s}=this.state;t={contentMarkdown:i,imageSignatures:"",objectIds:[],tags:JSON.stringify(s)},e&&e(t),this.setState({submissionInProgress:!1})}),C(this,"handleOnClickPost",()=>{this.state.userMentionOverLimitError||(this.setState({submissionInProgress:!0,isEmojiTrayOpen:!1}),this.handleOnClickPostFinal())}),C(this,"handleOnClickPostFinal",()=>{let{onAddItem:e}=this.props,t={},{textValue:i,tags:s}=this.state;t={contentMarkdown:i,imageSignatures:"",objectIds:[],tags:JSON.stringify(s)},e&&e(t),this.setState(w)}),C(this,"handleOnFinalDiscardItem",()=>{let{onCancelItem:e}=this.props;this.setState(w),e()}),C(this,"isSubmitEditDisabled",()=>{let{isTextChanged:e}=this.state;return!e}),C(this,"toggleShowConfirmDiscardModal",()=>{let{showConfirmDiscardModal:e}=this.state;this.setState({showConfirmDiscardModal:!e,isEmojiTrayOpen:!1})}),C(this,"renderConfirmDiscardModal",()=>{let e,t;let{statusType:i}=this.props;return"textInFlightNested"===i?(e=this.props.i18n.bt("Your changes will be discarded", "Your changes will be discarded", "Confirmation dialog before discarding changes", undefined, true),t=this.props.i18n.bt("Discard changes", "Discard changes", "Clear edits", undefined, true)):(e=this.props.i18n.bt("Once you delete a draft, you can’t undo it", "Once you delete a draft, you can’t undo it", "Confirmation before discarding changes", undefined, true),t=this.props.i18n.bt("Delete", "Delete", "delete draft of a post or comment", undefined, true)),(0,d.jsx)(m,{accessibilityModalLabel:this.props.i18n.bt("Confirm discard composer", "Confirm discard composer", "Confirm discarding a post or comment", undefined, true),cancelButtonText:this.props.i18n.bt("Cancel", "Cancel", "Cancel discarding a post or comment", undefined, true),confirmButtonText:t,detail:e,heading:this.props.i18n.bt("Are you sure?", "Are you sure?", "Confirm discarding a post or comment", undefined, true),onConfirm:this.handleOnFinalDiscardItem,onDismiss:this.toggleShowConfirmDiscardModal})}),C(this,"getReplyToEntity",e=>[e?`@${e.user.username} `:"",e?[{offset:0,object_id:e.user.id,length:e.user.username.length+1,tag_type:1}]:[]])}get isAggregatedComment(){let{objectType:e}=this.props;return e===v.o.pin||e===v.o.didIt||e===v.o.aggregatedComment}render(){let e,t;let{avatarSize:i,replyToObject:s,privatePin:l,statusType:o,viewingUser:n}=this.props,{isTextChanged:r,isEmojiTrayOpen:c,showConfirmDiscardModal:h,submissionInProgress:u,tags:p,textValue:m,userMentionOverLimitError:x}=this.state,[f,y]=this.getReplyToEntity(s),j=(0,d.jsx)(a.xu,{children:(0,d.jsx)(a.xv,{align:"end",color:"error",size:"100",children:(0,P.bl)(!1,this.props.i18n)})});return(e=this.isAggregatedComment&&l?this.props.i18n.bt("Add a public comment", "Add a public comment", "Add a comment", undefined, true):this.isAggregatedComment?this.props.i18n.bt("Add a comment", "Add a comment", "Prompt to add a comment", undefined, true):this.props.i18n.bt("Reply", "Reply", "Adding text to a community comment", undefined, true),t=this.isAggregatedComment?this.props.i18n.bt("Done", "Done", "Post a top level comment on a pin or tried it", undefined, true):this.props.i18n.bt("Reply", "Reply", "Posting a reply to a post or comment", undefined, true),"textInflightCreation"===o)?(0,d.jsxs)(a.xu,{column:12,display:"flex",justifyContent:"center",children:[(0,d.jsxs)(a.xu,{width:"100%",children:[(0,d.jsxs)(a.kC,{alignItems:"stretch",justifyContent:"start",children:[(0,d.jsx)(a.xu,{marginEnd:2,children:(0,d.jsx)(_.Z,{size:i,userKey:{type:"deprecated",data:n}})}),(0,d.jsx)(a.xu,{borderStyle:"sm",flex:"grow",padding:3,rounding:4,children:(0,d.jsx)(b.Z,{focusOnMount:!0,initialMentions:y,initialText:f,onAddMention:()=>{this.props.logContextEvent({event_type:8905,aux_data:{tag_type:1}})},onChange:this.handleChange,onSearchMentionCancel:()=>{this.props.logContextEvent({event_type:8908,aux_data:{tag_type:1}})},onSuggestionsPopoverOpen:()=>{this.props.logContextEvent({event_type:8907,aux_data:{tag_type:1}})},placeholder:e})})]}),x&&j,(0,d.jsxs)(a.xu,{display:"flex",justifyContent:"end",marginTop:4,children:[(0,d.jsx)(a.xu,{"data-test-id":"activity-item-create-cancel",children:(0,d.jsx)(a.zx,{color:"gray",onClick:r?this.toggleShowConfirmDiscardModal:this.handleOnFinalDiscardItem,text:this.props.i18n.bt("Cancel", "Cancel", "Cancel making post or comment", undefined, true)})}),(0,d.jsx)(a.xu,{marginStart:2,children:(0,d.jsx)(a.xu,{"data-test-id":"activity-item-create-submit",children:(0,d.jsx)(a.zx,{color:"red",disabled:!r||u||!m.length,onClick:this.handleOnClickPost,text:t})})})]})]}),h&&this.renderConfirmDiscardModal()]}):"textInFlightNested"===o?(0,d.jsxs)(a.xu,{column:12,"data-test-id":"activity-item-create",display:"flex",justifyContent:"center",children:[(0,d.jsxs)(a.xu,{width:"100%",children:[(0,d.jsx)(a.kC,{alignItems:"stretch",justifyContent:"start",children:(0,d.jsx)(a.xu,{borderStyle:"sm",flex:"grow",padding:3,rounding:4,children:(0,d.jsx)(b.Z,{focusOnMount:!0,initialMentions:p,initialText:m,onAddMention:()=>{this.props.logContextEvent({event_type:8905,aux_data:{tag_type:1}})},onChange:this.handleChange,onSearchMentionCancel:()=>{this.props.logContextEvent({event_type:8908,aux_data:{tag_type:1}})},onSuggestionsPopoverOpen:()=>{this.props.logContextEvent({event_type:8907,aux_data:{tag_type:1}})},placeholder:e})})}),x&&j,(0,d.jsxs)(a.xu,{display:"flex",justifyContent:"end",marginTop:4,children:[(0,d.jsx)(a.zx,{color:"gray",onClick:r?this.toggleShowConfirmDiscardModal:this.handleOnFinalDiscardItem,text:this.props.i18n.bt("Cancel", "Cancel", "Cancel making post or comment", undefined, true)}),(0,d.jsx)(a.xu,{marginStart:2,children:(0,d.jsx)(a.zx,{color:"red",disabled:this.isSubmitEditDisabled()||u,onClick:this.handleOnClickEdit,text:this.props.i18n.bt("Save", "Save", "comment save button", undefined, true)})})]})]}),h&&this.renderConfirmDiscardModal()]}):(0,d.jsx)(a.xu,{alignItems:"center",display:"flex",justifyContent:"between",rounding:2,children:(0,d.jsx)("div",{"aria-label":this.props.i18n.bt("Add comment field", "Add comment field", "ActivityItemCreate.textbox.accessibilityLabel", undefined, true),onClick:this.handleFocus,onKeyDown:this.handleFocus,role:"textbox",style:{cursor:"text",width:"100%"},tabIndex:0,children:(0,d.jsxs)(a.xu,{column:12,display:"flex",children:[(0,d.jsx)(a.xu,{width:48,children:(0,d.jsx)(_.Z,{size:i,userKey:{type:"deprecated",data:n}})}),(0,d.jsxs)(a.xu,{alignItems:"center",borderStyle:"sm",dangerouslySetInlineStyle:{__style:{borderRadius:"26px"}},display:"flex",height:48,marginStart:4,padding:4,width:"100%",children:[(0,d.jsx)("textarea",{"data-test-id":"communityItemTextBox",maxLength:2e3,name:"communityItemTextBox",onFocus:this.handleFocus,placeholder:e,rows:1,style:{background:"transparent",border:"0",display:r?"inline-block":"block",minHeight:"textStaticDisplay"===o?"":"50px",fontSize:"16px",outline:"0",overflowX:"hidden",resize:"none",whiteSpace:"pre-wrap",width:"100%"}}),(0,d.jsx)(g.Z,{isEmojiTrayOpen:c,onClick:()=>{this.setState({isEmojiTrayOpen:!c})}})]})]})})})}}C(A,"defaultProps",{imageSignature:"",onEnter:()=>{},text:"",widthAuto:!1});let z=(0,f.Z)(function(e){let{logContextEvent:t}=(0,x.v)(),i=(0,y.ZP)(),s=(0,j.Z)(),l=s.isAuth?{image_medium_url:s.imageMediumUrl,type:"user",username:s.username,full_name:s.fullName,first_name:"",id:""}:{id:"",type:"user",username:""};return(0,d.jsx)(A,{...e,i18n:i,logContextEvent:t,viewingUser:l})});var S=i(721748),k=i(178834),I=i(221354);function T(e,t,i){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?s:String(s))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let D=(0,i(179735).Z)(()=>Promise.all([i.e(88962),i.e(28164)]).then(i.bind(i,941214)),void 0,"app-common-react-components-Activities-Utils-Linkify");class E extends l.PureComponent{constructor(...e){super(...e),T(this,"parseText",()=>{let{tags:e,taggedUsers:t,text:i,size:s}=this.props;if(!e.length||!t||e.length!==t.length)return this.renderRegularText(i,"1");let l=0,o=[];return e.forEach((e,t)=>{let s=i.substring(l,e.offset);l=e.offset+e.length;let n=i.substring(e.offset,l);o=o.concat(this.renderRegularText(s,`${t}a`)).concat(this.renderTaggedText(n,t,`${t}b`))}),o=o.concat(this.renderRegularText(i.substring(l),"2")),(0,d.jsx)(a.xv,{inline:!0,overflow:"normal",size:s,children:o})}),T(this,"renderRegularText",(e,t)=>(0,d.jsx)(a.xv,{inline:!0,overflow:"normal",size:this.props.size,children:this.props.allowLink?(0,d.jsx)(D,{children:e}):e},t)),T(this,"renderTaggedText",(e,t,i)=>(0,d.jsx)(a.xv,{color:"shopping",inline:!0,overflow:"normal",size:this.props.size,weight:"bold",children:(0,d.jsx)(a.rU,{display:"inlineBlock",href:`/${this.props.taggedUsers[t].username}`,underline:"hover",children:e})},i))}render(){return(0,d.jsx)("span",{style:{whiteSpace:"pre-wrap",wordWrap:"break-word"},children:this.parseText()})}}T(E,"defaultProps",{allowLink:!0,size:"200"});var M=i(827872),R=i(310038),L=i(936437);function Z({createdAt:e,user:t,isHighlighted:i}){let s=(0,y.ZP)(),l=(0,L.Z)(),o=(0,d.jsx)(a.xv,{color:"subtle",size:"200",children:(0,R.A7)(e,s,l)}),n=(0,d.jsxs)(a.xv,{color:"subtle",size:"200",children:["· ",s.bt("Highlighted", "Highlighted", "pin.comments.highlight", undefined, true)]});return(0,d.jsxs)(a.xu,{alignItems:"start",display:"flex",marginEnd:-1,marginStart:-1,children:[(0,d.jsx)(a.xu,{paddingX:1,children:(0,d.jsx)(a.xv,{size:"200",weight:"bold",children:(0,d.jsx)(a.rU,{href:`/${t.username}/`,children:(0,R.YD)(t)})})}),(0,d.jsx)(a.xu,{paddingX:1,children:o}),i&&(0,d.jsx)(a.xu,{paddingX:1,children:n})]})}var U=i(909483),O=i(961754),H=i(750077),B=i(389354),F=i(111929);let N=(0,l.lazy)(()=>Promise.all([i.e(97270),i.e(94109),i.e(63954),i.e(61873),i.e(40846)]).then(i.bind(i,279985)));function V({avatarSize:e="sm",commentCount:t,contentImage:i,contentImageSignature:s,contentText:o,flyout:n,handleOnEditCancel:r,handleOnEdited:c,handleHelpfulClick:h,handleLikeClick:u,handleReplyClick:p,handleReplyCountClick:m,helpfulCount:g,hideAddObjects:x,hideReplyCount:f,inEditMode:j,isHighlighted:v,isLikedByMe:b,isMarkedHelpfulByMe:P,isPlainComment:C,parentObject:w,pins:A,reactionCounts:S,responsePinId:k,slotIndex:T,taggedUsers:D,tags:R,truncateText:L,commentId:V,createdAt:$,commentAuthor:W,type:G,isORBACProfileManager:Y}){let X=(0,U.K)(),K=(0,y.ZP)(),[q,J]=(0,l.useState)(V===X),{isLoaded:Q,data:ee}=(0,O.Z)(k?{name:"PinResource",options:{id:k,field_set_key:"detailed"}}:null);(0,l.useEffect)(()=>{V===X&&I.Z.setTimeout(()=>{J(!1)},1500)},[]);let et=Q&&!!k;return(0,d.jsx)(a.xu,{"data-test-id":"canonical-comment",children:(0,d.jsxs)(a.xu,{display:"flex",marginBottom:C?4:0,children:[(0,d.jsx)(a.xu,{marginEnd:2,children:(0,d.jsx)(_.Z,{size:e,userKey:{type:"deprecated",data:W}})}),(0,d.jsxs)(a.xu,{flex:"grow",marginStart:2,children:[(0,d.jsx)(a.xu,{borderStyle:"sm",dangerouslySetInlineStyle:{__style:{borderColor:j?"transparent":void 0,transition:"1000ms",backgroundColor:q?"lightGray":void 0}},padding:j?0:3,rounding:4,children:j?(0,d.jsx)(z,{addedImage:i,addedObjects:A,hideAddObjects:x,imageSignature:s,objectType:G,onAddItem:()=>{},onCancelItem:r,onEditItem:c,onEnter:()=>{},parentObjectId:w.id,statusType:"textInFlightNested",tags:R,text:o,widthAuto:!0}):(0,d.jsxs)(l.Fragment,{children:[(0,d.jsx)(Z,{createdAt:$,isHighlighted:v,user:W}),L?(0,d.jsx)(M.Z,{allowReveal:!0,size:"100",taggedUsers:D,tags:R,text:o}):(0,d.jsx)(E,{size:"100",taggedUsers:D,tags:R,text:o}),k&&et&&ee&&(0,d.jsx)(H.Z,{fallback:(0,d.jsx)(B.Z,{accessibilityLabel:K.bt("Loading comment reply Pin preview", "Loading comment reply Pin preview", "Loading pin previews for comment reply comments component", undefined, true)}),children:(0,d.jsx)(a.xu,{marginTop:1,maxWidth:"21%",children:(0,d.jsx)(N,{pinKey:{type:"deprecated",data:ee},slotIndex:T,surface:"CommentReply"})})})]})}),!Y&&!et&&!j&&!C&&(0,d.jsx)(a.xu,{padding:1,children:(0,d.jsx)(F.Z,{commentCount:t,flyout:j?null:n,helpfulCount:g,hideReplyCount:f,isLikedByMe:b,isMarkedHelpfulByMe:P,onHelpfulClick:h,onLikeClick:u,onReplyClick:p,onReplyCountClick:m,reactionCounts:S,small:!0})})]})]})})}var $=i(622468),W=i(255590),G=i(106874),Y=i(642593),X=i(476198),K=i(788388),q=i(240760),J=i(468808),Q=i(207630),ee=i(901450),et=i(625987),ei=i(60983),es=i(423057),el=i(900492),eo=i(66560),en=i(762577);let ea=({aggregatedCommentId:e,apdId:t,creatorId:i,depth:s,didItOwnerId:n,isManagedView:r,objectType:c,onUpdate:h,parentObjectId:u,pinDomainOwnerId:_,pinId:g,slotIndex:f,viewerId:j,showHighlightEducator:b,numHighlights:P,canSetHighlight:C,isORBACProfileManager:w})=>{let{logContextEvent:A}=(0,x.v)(),S=(0,y.ZP)(),{isLoaded:I}=(0,O.Z)({name:"PinResource",options:{id:g,field_set_key:"detailed"}}),{showToast:T}=(0,ee.F9)(),{reportComment:D}=(0,en.f)(),E=(0,et.lV)(),{aggregatedCommentsHiddenForUser:M,deleteCommentMention:R,toggleAggregatedCommentHelpful:L,toggleAggregatedCommentHighlight:Z,toggleAggregatedCommentLike:U,updateAggregatedComment:H}=(0,et.nf)(),B=(0,$.Z)(),F=(0,W.Z)(),N=E[e],{nativeEngagementsHiddenForUser:ea}=(0,ei.G)(),[er,ed]=(0,l.useState)(!1),[ec,eh]=(0,l.useState)(!1),[e_,ep]=(0,l.useState)(!1),[em,ex]=(0,l.useState)(!1),[ef,ey]=(0,l.useState)(!1),[ej,ev]=(0,l.useState)(!1),eb=(0,o.I0)();(0,l.useEffect)(()=>{eb((0,J.U)("AggregatedCommentResource",{options:{commentId:e}}))},[eb,e]),(0,l.useEffect)(()=>{h&&h()},[h]);let eP=(0,eo.S6)()(g),eC="pin";if(eP){let e=!!eP.videos?.video_list;eP.story_pin_data_id?eC="story":e&&(eC="video")}if(!N||!N.user)return null;let{comment_response_pin:ew,comment_count:eA,created_at:ez,helpful_count:eS,marked_helpful_by_me:ek,reaction_by_me:eI,reaction_counts:eT,tagged_users:eD,tags:eE,text:eM,user:{id:eR,username:eL},highlighted_by_pin_owner:eZ}=N,eU=s===eu,eO=eT[1],eH=()=>{U({aggregatedCommentId:e,isLikedByMe:!!eI})},eB=()=>{L({aggregatedCommentId:e,isMarkedHelpfulByMe:!!ek})},eF=()=>{if(P&&P>=3){T(({hideToast:e})=>(0,d.jsx)(X.ZP,{onHide:e,text:S.bt("Only 3 comments can be highlighted", "Only 3 comments can be highlighted", "closeup.pinActionDropDown.commentHighlightMaxNumberToast", undefined, true)}));return}Z({aggregatedCommentId:e,pinId:g,isHighlighted:!1}),T(({hideToast:t})=>(0,d.jsx)(X.ZP,{onHide:t,primaryAction:{accessibilityLabel:S.bt("Undo comment highlight or comment highlight removal", "Undo comment highlight or comment highlight removal", "closeup.pinActionDropDown.commentHighlightToast.a11yUndoButton", undefined, true),label:S.bt("Undo", "Undo", "closeup.pinActionDropDown.commentHighlightToast.UndoButton", undefined, true),size:"lg",onClick:()=>{Z({aggregatedCommentId:e,pinId:g,isHighlighted:!0})}},text:S.bt("Comment highlighted", "Comment highlighted", "closeup.pinActionDropDown.commentHighlightToast", undefined, true)}))},eN=()=>{Z({aggregatedCommentId:e,pinId:g,isHighlighted:!0}),T(({hideToast:t})=>(0,d.jsx)(X.ZP,{onHide:t,primaryAction:{accessibilityLabel:S.bt("Undo comment highlight or comment highlight removal", "Undo comment highlight or comment highlight removal", "closeup.pinActionDropDown.commentHighlightToast.a11yUndoButton", undefined, true),label:S.bt("Undo", "Undo", "closeup.pinActionDropDown.commentHighlightToast.UndoButton", undefined, true),size:"lg",onClick:()=>{Z({aggregatedCommentId:e,pinId:g,isHighlighted:!1})}},text:S.bt("Highlight removed", "Highlight removed", "closeup.pinActionDropDown.commentHighlightRemovalToast", undefined, true)}))},eV=()=>{ep(!e_)},e$=async({contentMarkdown:t,tags:i})=>{let s;let l=e;eV(),eh(!0),eU&&(l=u,s=e),await eb(B({objectType:v.o.aggregatedComment,objectId:l,tags:i,text:t,replyToCommentId:s})),eh(!1)},eW=()=>{ed(!0)},eG=()=>{ed(!1)},eY=t=>{H({commentId:e,force:!0,tags:t.tags,text:t.contentMarkdown}),ed(!1)},eX=()=>{R(e),A({event_type:8909,component:13464,view_type:3,view_parameter:140,aux_data:{tag_id:j,tag_type:1}}),T(({hideToast:e})=>(0,d.jsx)(X.ZP,{onHide:e,text:S.bt("@mention removed", "@mention removed!", "closeup.pinActionDropDown.mentionRemovalToast", undefined, true)}))},eK=()=>{ex(!0)},eq=()=>{ev(!0)},eJ=()=>{ex(!1),ey(!1),ev(!1)},eQ=()=>{D(e,u,c===v.o.aggregatedComment?"aggregatedcomment":"userdiditdata")},e0=()=>{let e=[eR,i,n,_].includes(j),t=j===eR,s=j!==eR,l=j!==eR,o=eD.filter(({id:e})=>e===j).length>0;return(0,d.jsx)(k.Z,{handleBlockUser:l?eq:null,handleClickReport:s?eQ:null,handleDelete:e?eK:null,handleHighlight:C&&!eZ?eF:null,handleOnEdit:t?eW:null,handleRemoveHighlight:C&&eZ?eN:null,handleRemoveMention:o?eX:null,showHighlightEducator:b,small:!0})};return(0,d.jsxs)(l.Fragment,{children:[(0,d.jsx)(K.F,{componentType:c===v.o.pin?13696:13697,contextLogData:{objectId:N.id},impressionAuxFields:{commentId:N.id,pinId:g,pinType:eC,parentId:u,parentType:c,commentType:v.o.aggregatedComment},impressionType:"Comment",isPaused:!I,loggingId:N.id,slotIndex:f,viewType:3,children:({impressionTrackerRef:t})=>(0,d.jsx)(a.xu,{ref:t,"data-test-id":"aggregatedCommentContainer-comment",children:(0,d.jsx)(V,{avatarSize:eU?"sm":"md",commentAuthor:N.user,commentCount:eA,commentId:e,contentText:eM,createdAt:ez,flyout:e0(),handleHelpfulClick:eB,handleLikeClick:eH,handleOnEditCancel:eG,handleOnEdited:eY,handleReplyClick:eV,helpfulCount:eS,hideAddObjects:!0,hideReplyCount:!0,inEditMode:er,isHighlighted:eZ,isLikedByMe:!!eI,isMarkedHelpfulByMe:ek,isORBACProfileManager:w,parentObject:{id:u},reactionCounts:eT,responsePinId:ew?.id,slotIndex:f,taggedUsers:eD,tags:eE,truncateText:!0,type:v.o.aggregatedComment})})}),e_&&(0,d.jsx)(a.xu,{dangerouslySetInlineStyle:{__style:{paddingLeft:eU?0:48}},"data-test-id":"aggregatedCommentContainer-replyComposer",children:(0,d.jsx)(a.xu,{display:"flex",marginTop:2,children:(0,d.jsx)(a.xu,{flex:"grow",children:(0,d.jsx)(z,{avatarSize:"sm",hideAddObjects:!0,objectType:v.o.aggregatedComment,onAddItem:e$,onCancelItem:eV,onEnter:()=>{},parentObjectId:u,replyToObject:eU?N:null,statusType:"textInflightCreation"})})})}),eA>0&&(0,d.jsxs)(a.xu,{dangerouslySetInlineStyle:{__style:{paddingLeft:48}},"data-test-id":"aggregatedCommentContainer-replyList",children:[(0,d.jsx)(eg,{baseIndex:f+1,commentCount:eA,creatorId:i,depth:s,didItOwnerId:n,isManagedView:r,isORBACProfileManager:w,objectId:e,objectType:v.o.aggregatedComment,onUpdate:h,parentObjectId:u,pinDomainOwnerId:_,pinKey:null!=eP?{type:"deprecated",data:eP}:null,variant:"legacy"}),(0,d.jsx)(a.$j,{accessibilityLabel:S.bt("Comments loading", "Comments loading", " - ", undefined, true),show:ec})]}),em&&(0,d.jsx)(m,{accessibilityModalLabel:S.bt("Deleting a comment", "Deleting a comment", "closeup.deleteCommentModal.label", undefined, true),cancelButtonText:S.bt("Cancel", "Cancel", "closeup.deleteCommentModal.cancelButton", undefined, true),confirmButtonText:S.bt("Delete", "Delete", "closeup.deleteCommentModal.confirmButton", undefined, true),detail:S.bt("This comment will be deleted", "This comment will be deleted", "closeup.deleteCommentModal.detailText", undefined, true),heading:S.bt("Are you sure?", "Are you sure?", "closeup.deleteCommentModal.heading", undefined, true),onConfirm:()=>{eb(F({aggregatedCommentId:e,aggregatedPinId:t,feedType:"aggregatedComments",type:eU?Y.Rv.REPLY_TO_AGGREGATED:Y.Rv.TOP,parentId:u,updateParentCommentCount:!0,pinId:g}))},onDismiss:eJ}),ef&&(0,d.jsx)(p.ZP,{accessibilityModalLabel:S.bt("Users who have liked this.", "Users who have liked this.", "closeup.comment.showLikeListModal.label", undefined, true),heading:(0,Q.Z)(S.nbt(["{{count}} like", "{{count}} likes"], eO, "closeup.comment.showLikeListModal.heading", true),{count:eO.toString()}),onDismiss:eJ,size:"md",children:(0,d.jsx)(G.Xd,{id:e})}),ej&&(0,d.jsx)(es.default,{firstName:eL,onBlockUser:()=>{eb((0,el.Ge)({id:eR,blockSource:"comment",blockContext:e,logContextEvent:A})),M(eR),ea(eR),eJ(),T(({hideToast:e})=>(0,d.jsx)(X.ZP,{onHide:e,text:(0,q.nk)(S.bt("You've blocked {{ username }}", "You've blocked {{ username }}", "comment.blockAuthor.toast", undefined, true),{username:eL}).join("")}))},onClearModal:eJ})]})};var er=i(47848),ed=i(868808),ec=i(969119),eh=i(403764);let eu=2,e_=void 0!==s?s:s=i(339e3),ep=({baseIndex:e=0,commentCount:t,creatorId:i,depth:s=0,didItOwnerId:o,feedItems:n,feedResourceName:r,initialLoadCount:c,isManagedView:h,objectId:_,objectType:p,onUpdate:m,parentObjectId:g,pinDomainOwnerId:f,pinKey:b,privatePin:P,shouldFeatureComment:C=!1,variant:w,isORBACProfileManager:A})=>{let{logContextEvent:k}=(0,x.v)(),I=(0,y.ZP)(),[T,D]=(0,l.useState)(!1),[E,M]=(0,l.useState)(!1),R=(0,j.Z)(),L=(0,U.K)(),Z=(0,u.TH)(),{comment_is_hidden:H="0"}=(0,ed.mB)(Z.search),B=1===parseInt(H,10),{showOneToast:F}=(0,ee.F9)(),N=(0,$.Z)(),V=(0,er.Z)(e_,b);(0,ec.Z)(()=>{if(L&&B&&C){let e=I.bt("Sorry, the comment has been hidden", "Sorry, the comment has been hidden", "AggregatedCommentList.featuredComment.isHidden", undefined, true);F(({hideToast:t})=>(0,d.jsx)(X.ZP,{onHide:t,text:e}))}});let{fetchMore:W,isAtEnd:G,isLoaded:Y}=(0,O.Z)({name:r,options:{objectId:_,page_size:c||2,redux_normalize_feed:!0,featured_ids:C&&L&&!B?[L]:null}}),K=V?.entityId,J=V&&V.pinner?V.pinner.entityId:"",Q=!!V&&V.storyPinDataId,et=V?.aggregatedPinData?.entityId??"";(0,l.useEffect)(()=>{Y&&m&&m()},[Y,m]);let ei=()=>{D(!T)},es=async({contentMarkdown:e,tags:t})=>{ei(),M(!0);try{N({objectType:p,objectId:_,pinId:K,tags:t,text:e}),p===v.o.pin&&k({event_type:7,object_id_str:K,aux_data:{num_user_mention_tags:(t?JSON.parse(t):[]).length,...Q?{creator_id:i,story_pin_data_id:Q}:{}}})}catch(e){}M(!1)},el=!!n&&Y&&t>n.length&&!G,eo=n?t-n.length:0,en=(0,q.nk)(I.nbt(["{{commentCount}} comment", "{{commentCount}} comments"], eo, "Show comments link with count", true),{commentCount:String(eo)}).join(""),eh=p===v.o.aggregatedComment,eu=p===v.o.pin&&(n&&0===n.length||0===t)&&Y&&!E,ep="default"===w,em=0===s,eg=em&&V&&V.highlightedAggregatedComments?V.highlightedAggregatedComments:[],ex=em&&R.isAuth&&R.id===J,ef=ex;return(0,d.jsxs)(a.xu,{"data-test-id":"aggregated-comment-list",marginTop:eh&&!ep?2:0,paddingY:eh||ep?0:2,children:[!!K&&eg.map((t,l)=>(0,d.jsx)(a.xu,{marginBottom:2,children:(0,d.jsx)(ea,{aggregatedCommentId:t,apdId:et,canSetHighlight:ex,creatorId:i,depth:s+1,didItOwnerId:o,isManagedView:h,isORBACProfileManager:A,objectType:p,onUpdate:m,parentObjectId:p===v.o.pin?K:_,pinDomainOwnerId:f,pinId:K,slotIndex:e+l,viewerId:R.isAuth?R.id:""})},t)),!!K&&n?.filter(e=>!eg.includes(e.id)).map(({id:t},l)=>{let n=ef;return ef=!1,d.jsx(a.xu,{marginBottom:2,children:d.jsx(ea,{aggregatedCommentId:t,apdId:et,canSetHighlight:ex,creatorId:i,depth:s+1,didItOwnerId:o,isManagedView:h,isORBACProfileManager:A,numHighlights:eg.length,objectType:p,onUpdate:m,parentObjectId:p===v.o.pin?K:_,pinDomainOwnerId:f,pinId:K,showHighlightEducator:n,slotIndex:e+eg.length+l,viewerId:R.isAuth?R.id:""})},t)}),(0,d.jsx)(a.$j,{accessibilityLabel:I.bt("Comments loading", "Comments loading", " - ", undefined, true),show:!Y||E}),el&&(0,d.jsx)(a.xu,{marginTop:3,children:(0,d.jsx)(S.Z,{handleClick:W,text:en})}),eu&&(0,d.jsx)(a.xu,{paddingY:ep?0:2,children:(0,d.jsx)(a.xv,{size:ep?"100":"200",children:I.bt("Share feedback, ask a question or give a high five", "Share feedback, ask a question or give a high five", " - ", undefined, true)})}),!A&&p!==v.o.aggregatedComment&&!h&&(0,d.jsx)(a.xu,{display:"flex",marginTop:6,children:(0,d.jsx)(a.xu,{"data-test-id":"add-comment",flex:"grow",children:(0,d.jsx)(z,{hideAddObjects:!0,objectType:p,onAddItem:es,onCancelItem:ei,onEnter:ei,parentObjectId:g||"",privatePin:P,replyToObject:null,statusType:T?"textInflightCreation":"textStaticDisplay"})})})]})},em=e=>(0,o.v9)(({feeds:t})=>t[`${eh.Z.AGGREGATED_COMMENTS}:${e}`]),eg=e=>(0,d.jsx)(ep,{...e,feedItems:em(e.objectId)??[],feedResourceName:"AggregatedCommentReplyFeedResource"}),ex=e=>(0,d.jsx)(ep,{...e,feedItems:em(e.objectId)??[],feedResourceName:"DidItCommentsResource"});function ef(e){let{item:{images:t}}=e,i=e.item.pin&&e.item.pin.title||"",s=t.length>0,l=s?t[0]["750x"]:null;if(!s||!l)return null;let o=t[0]["750x"].url;return(0,d.jsx)(a.zd,{rounding:2,wash:!0,children:(0,d.jsx)(a.Ee,{alt:i,color:"#efefef",naturalHeight:l.height,naturalWidth:l.width,src:o},o)})}var ey=i(410619),ej=i(194054);function ev(e){let t=(0,y.ZP)();return(0,d.jsx)(ej.Z,{thriftComponentType:193,...e,children:({onTriedItButtonClick:e})=>(0,d.jsx)("button",{onClick:e,style:{background:"none",border:"none",padding:"0"},children:(0,d.jsx)(a.xu,{paddingX:2,paddingY:1,children:(0,d.jsx)(a.xv,{weight:"bold",children:t.bt("Save", "Save", "comment save button", undefined, true)})})})})}var eb=i(609399),eP=i(953059),eC=i(803611),ew=i(400416),eA=i(642758),ez=i(613756),eS=i(983284);function ek(e,t,i){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?s:String(s))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let eI=(e,t)=>t?e-1:e+1,eT={background:"none",border:"none",padding:"0",width:"100%"},eD=({isLikedByMe:e,onClick:t})=>{let i=(0,y.ZP)(),s=(0,eC.Z)();return(0,d.jsx)(a.hU,{accessibilityLabel:i.bt("Like", "Like", " - ", undefined, true),icon:"heart",iconColor:e?"red":"gray",onClick:()=>{s?s():t()},size:"md"})};class eE extends l.PureComponent{constructor(...e){super(...e),ek(this,"state",{isLikedByMe:this.props.item.liked_by_me,likeCount:this.props.item.like_count,showDeleteModal:!1,showEditModal:!1,showFlyout:!1,showLikesListModal:!1,showShareFlyout:!1,isDeleteHover:!1,isReportHover:!1}),ek(this,"handleClickthrough",()=>{let{handlePinClickLogging:e,logContextEvent:t,item:{id:i}}=this.props;e&&e(),t({event_type:101,component:172,element:1263,object_id_str:i})}),ek(this,"handleClickHashTag",()=>{let{logContextEvent:e,item:{id:t}}=this.props;e({event_type:101,component:172,element:10194,object_id_str:t})}),ek(this,"handleToggleLikesListModal",()=>this.setState(({showLikesListModal:e})=>({showLikesListModal:!e}))),ek(this,"handleClickLike",()=>{let{item:{id:e},viewType:t,logContextEvent:i}=this.props,{isLikedByMe:s,likeCount:l}=this.state;i({event_type:101,component:172,element:1353,object_id_str:e,view_type:t}),this.setState({isLikedByMe:!s,likeCount:eI(l,s)}),(0,ew.Z)({url:`/v3/did_it/${e}/like/`,method:s?"DELETE":"POST"})}),ek(this,"handleToggleFlyout",()=>this.setState(({showFlyout:e})=>({showFlyout:!e,showShareFlyout:!1}))),ek(this,"handleShowShareFlyout",()=>this.setState({showShareFlyout:!0})),ek(this,"handleDismissFlyout",()=>{this.state.showEditModal||this.setState({showFlyout:!1,showShareFlyout:!1})}),ek(this,"handleShowReportModal",()=>{let{item:{id:e,pin:{aggregated_pin_data:t}},removeReportedActivity:i,reportComment:s}=this.props;s(e,t?.id??"","userdiditdata"),i&&i(e)}),ek(this,"handleShowDeleteModal",()=>this.setState({showDeleteModal:!0})),ek(this,"handleDeleteConfirmation",e=>{let{item:{id:t,pin:{aggregated_pin_data:i={},id:s},user:l},deleteUserDidItData:o,logContextEvent:n}=this.props;if(this.setState({showDeleteModal:!1}),!e||!l)return;let{username:a}=l;n({event_type:101,view_type:101,component:192,element:1264,object_id_str:s}),o({aggregatedPinDataId:i?.id,id:t,isOwnedByMe:this.isOwnedByCurrentUser,pinId:s,username:a})}),ek(this,"handleToggleEditModal",e=>this.setState({showEditModal:e,showFlyout:e})),ek(this,"handleClickHelpful",()=>{let{didItDataId:e,item:{marked_helpful_by_me:t},toggleHelpful:i}=this.props;i({didItDataId:e,isMarkedHelpfulByMe:!!t})}),ek(this,"handleDeleteMouseEnter",()=>this.setState({isDeleteHover:!0})),ek(this,"handleDeleteMouseLeave",()=>this.setState({isDeleteHover:!1})),ek(this,"handleReportMouseEnter",()=>this.setState({isReportHover:!0})),ek(this,"handleReportMouseLeave",()=>this.setState({isReportHover:!1})),ek(this,"renderFlyout",()=>{let{creatorId:e,item:{details:t,id:i,images:s,pin:l,privacy:o,user:n},viewer:r}=this.props,{aggregated_pin_data:c={},id:h,images:u={},link_domain:_={},rich_metadata:p={},title:m}=l||{},{showFlyout:g,showShareFlyout:x}=this.state,f=(_||{}).official_user||{},y=(p||{}).title,j={description:t,id:i,imageUrl:s.length>0?s?.[0]?.["550x"]?.url:u["136x136"]?.url,name:y||this.props.i18n.bt("this idea", "this idea", " - ", undefined, true),type:eS.d.DID_IT,url:`/pin/${h}/activity/tried/${i}`},v=this.isOwnedByCurrentUser||r.isAuth&&r.id===f.id||r.isAuth&&r.id===e;return(0,d.jsxs)(a.xu,{children:[(0,d.jsx)(a.xu,{ref:e=>{this.flyoutAnchor=e},children:(0,d.jsx)(a.hU,{accessibilityExpanded:g,accessibilityHaspopup:!0,accessibilityLabel:this.props.i18n.bt("more options", "more options", "accessible label for button to see more options on report content", undefined, true),icon:"ellipsis",iconColor:"gray",onClick:this.handleToggleFlyout,size:"sm"})}),g&&(0,d.jsx)(a.mh,{children:(0,d.jsx)(a.xu,{alignSelf:"end",children:(0,d.jsx)(a.J2,{anchor:this.flyoutAnchor,idealDirection:"down",onDismiss:this.handleDismissFlyout,size:x?"lg":"xs",children:x?(0,d.jsx)(ez.Z,{component:56,onHide:this.handleToggleFlyout,sendType:"did_it",sharedObject:j,viewType:3}):(0,d.jsx)(a.xu,{alignSelf:"start",color:"default",column:12,display:"flex",position:"relative",rounding:2,children:(0,d.jsxs)(a.sg,{span:12,children:["public"===o&&(0,d.jsx)("button",{onClick:this.handleShowShareFlyout,style:eT,children:(0,d.jsx)(a.xu,{display:"flex",paddingX:2,paddingY:1,children:(0,d.jsx)(a.xv,{weight:"bold",children:this.props.i18n.bt("Share", "Share", " - ", undefined, true)})})}),(0,d.jsx)(a.xu,{display:"flex",paddingX:2,paddingY:1,children:(0,d.jsx)(a.rU,{href:this.pinURL,onClick:this.handleClickthrough,children:(0,d.jsx)(a.xv,{weight:"bold",children:this.props.i18n.bt("Go to Pin", "Go to Pin", " - ", undefined, true)})},this.pinURL)}),n&&(this.isOwnedByCurrentUser||v)?(0,d.jsxs)(a.xu,{children:[this.isOwnedByCurrentUser&&(0,d.jsx)(a.kC,{alignItems:"stretch",justifyContent:"start",children:(0,d.jsx)(ev,{aggregatedPinDataId:c?.id,isDoneByMe:this.isOwnedByCurrentUser,loggedInUser:n,onToggleModal:this.handleToggleEditModal,pinId:h,pinTitle:m,userDidItDataId:i})}),v&&(0,d.jsx)("button",{onClick:this.handleShowDeleteModal,style:eT,children:(0,d.jsx)(a.xu,{"data-test-id":"flyout-delete-button",display:"flex",paddingX:2,paddingY:1,children:(0,d.jsx)(a.xv,{weight:"bold",children:this.props.i18n.bt("Delete", "Delete", " - ", undefined, true)})})})]}):(0,d.jsx)("button",{onClick:this.handleShowReportModal,style:eT,children:(0,d.jsx)(a.xu,{display:"flex",paddingX:2,paddingY:1,children:(0,d.jsx)(a.xv,{weight:"bold",children:this.props.i18n.bt("Report this content", "Report this content", " - ", undefined, true)})})})]})})})})})]})}),ek(this,"renderStatsBar",()=>{let{item:{comment_count:e,done_at:t,marked_helpful_by_me:i,helpful_count:s},isManagedView:l,viewer:o}=this.props,n=this.props.item.pin&&this.props.item.pin.link_domain||{},{isLikedByMe:r,likeCount:c,isDeleteHover:h,isReportHover:u}=this.state,_=(0,Q.Z)(this.props.i18n.nbt(["{{likeCount}} like", "{{likeCount}} likes"], c, " - ", true),{likeCount:c}),p=(0,Q.Z)(this.props.i18n.nbt(["{{commentCount}} comment", "{{commentCount}} comments"], e, " - ", true),{commentCount:e}),m=n.official_user||{},g=this.isOwnedByCurrentUser||o.isAuth&&o.id===m.id,x=this.props.getHumanizedTimeSince(t,!0);return(0,d.jsxs)(a.xu,{alignItems:"center",column:12,display:"flex",children:[(0,d.jsxs)(a.kC,{alignItems:"stretch",justifyContent:"start",children:[(0,d.jsx)(a.xv,{size:"200",children:l?x:(0,d.jsx)(eP.Z,{dateFormatType:eP.k.LONG,useUTC:!1,value:new Date(t)})}),e>0&&(0,d.jsx)(a.xu,{marginStart:6,children:(0,d.jsx)(a.xv,{size:"200",weight:"bold",children:p})}),c>0&&(0,d.jsx)(a.xu,{"data-test-id":"did_it_show_likes_tap_area",marginStart:6,children:(0,d.jsx)(a.iP,{onTap:this.handleToggleLikesListModal,children:(0,d.jsx)(a.xv,{size:"200",weight:"bold",children:_})})})]}),(0,d.jsxs)(a.kC,{alignItems:"stretch",flex:"grow",justifyContent:"end",children:[(0,d.jsx)(a.xu,{display:"flex",justifyContent:c>0?"between":"end",marginBottom:1,marginTop:1,children:o.isAuth&&(0,d.jsx)(eD,{isLikedByMe:r,onClick:this.handleClickLike})}),(0,d.jsx)(a.xu,{display:"flex",paddingY:3,children:(0,d.jsx)(F.N,{helpfulCount:s,isMarkedHelpfulByMe:i,onHelpfulClick:this.handleClickHelpful})})]}),l&&(0,d.jsx)(a.kC,{alignItems:"stretch",flex:"none",children:(0,d.jsx)(a.iP,{onMouseEnter:this.handleReportMouseEnter,onMouseLeave:this.handleReportMouseLeave,onTap:this.handleShowReportModal,rounding:"pill",children:(0,d.jsx)(a.xu,{padding:2,children:(0,d.jsx)(a.xv,{color:u?"default":"subtle",size:"200",weight:"bold",children:this.props.i18n.bt("Report", "Report", " - ", undefined, true)})})})}),l&&g&&(0,d.jsx)(a.kC,{alignItems:"stretch",flex:"none",children:(0,d.jsx)(a.iP,{onMouseEnter:this.handleDeleteMouseEnter,onMouseLeave:this.handleDeleteMouseLeave,onTap:this.handleShowDeleteModal,rounding:"pill",children:(0,d.jsx)(a.xu,{padding:2,children:(0,d.jsx)(a.xv,{color:h?"default":"subtle",size:"200",weight:"bold",children:this.props.i18n.bt("Delete", "Delete", " - ", undefined, true)})})})})]})}),ek(this,"renderPinInfoBar",()=>{let e;let{item:{images:t,pin:i,user:s},isManagedView:l}=this.props,{full_name:o}=s||{},{dominant_color:n,images:r={},rich_metadata:c={},title:h}=i,u=(c||{}).title;return e=this.isOwnedByCurrentUser&&u?(0,q.nk)(this.props.i18n.bt("You tried {{pinTitleForTriedByText}}", "You tried {{pinTitleForTriedByText}}", "Navigating to a Pin from a try", undefined, true),{pinTitleForTriedByText:u}):u?(0,q.nk)(this.props.i18n.bt("{{fullName}} tried {{pinTitleForTriedByText}}", "{{fullName}} tried {{pinTitleForTriedByText}}", "Navigating to a Pin from a try", undefined, true),{fullName:o,pinTitleForTriedByText:u}):this.isOwnedByCurrentUser?this.props.i18n.bt("See the Pin you tried", "See the Pin you tried", "Navigating to a Pin from a try", undefined, true):this.props.i18n.bt("See the Pin that inspired it", "See the Pin that inspired it", "call to action - navigating to a Pin from a try", undefined, true),(0,d.jsx)(a.xu,{dangerouslySetInlineStyle:{__style:t.length?{backgroundImage:"linear-gradient(to bottom, rgba(118, 118, 118, 0), rgba(0, 0, 0, 0.2) 33%, rgba(0, 0, 0, 0.5) 66%, rgba(0, 0, 0, 0.7))"}:{}},rounding:t.length?2:0,children:(0,d.jsx)(a.Tg,{href:this.pinURL,onTap:this.handleClickthrough,children:(0,d.jsxs)(a.xu,{alignItems:"center",display:"flex",paddingX:t.length?3:0,paddingY:3,children:[(0,d.jsxs)(a.xu,{alignItems:"center",display:"flex",flex:"grow",justifyContent:"start",marginEnd:2,children:[(0,d.jsx)(a.xu,{marginEnd:3,width:60,children:(0,d.jsx)(a.zd,{rounding:2,wash:!0,children:(0,d.jsx)(a.Ee,{alt:h??"",color:n??"transparent",naturalHeight:60,naturalWidth:60,src:r["136x136"]?.url??""})})}),(0,d.jsxs)(a.xv,{color:t.length?"inverse":"default",size:l?"100":"300",weight:"bold",children:[" ",e," "]})]}),(0,d.jsx)(a.JO,{accessibilityLabel:this.props.i18n.bt("See Pin", "See pin", " - ", undefined, true),color:t.length?"inverse":"default",icon:"arrow-forward",size:32})]})},this.pinURL)})})}get isOwnedByCurrentUser(){let{viewer:e,item:t}=this.props;return!!(e.isAuth&&t.user&&e.id===t.user.id)}get pinURL(){return`/pin/${this.props.item.pin.id}/`}render(){let{creatorId:e,isManagedView:t,item:i,viewType:s}=this.props,{likeCount:l,showDeleteModal:o,showLikesListModal:n}=this.state,{comment_count:r,details:c,id:u,images:_,pin:m,user:g,videos:x}=i,{full_name:f,id:y,image_medium_url:j,username:b}=g||{},P=`/${b}/`;(0,Q.Z)(this.props.i18n.nbt(["{{likeCount}} like", "{{likeCount}} likes"], l, " - ", true),{likeCount:l}),(0,Q.Z)(this.props.i18n.nbt(["{{commentCount}} comment", "{{commentCount}} comments"], r, " - ", true),{commentCount:r});let C=!!x?.[0]?.video_list?.V_HLSV4,w=!!_[0]?.["750x"],A=w||C,z=82!==s,S=w&&z;return(0,d.jsxs)(a.xu,{alignItems:"stretch",direction:"column",display:"flex",justifyContent:"between",paddingY:7,children:[(0,d.jsxs)(a.xu,{alignItems:"center",column:12,display:"flex",children:[(0,d.jsx)(a.kC,{alignItems:"center",children:(0,d.jsx)(a.xu,{marginEnd:3,width:t?36:42,children:(0,d.jsx)(a.Tg,{href:P,onTap:this.handleClickthrough,rounding:"circle",children:(0,d.jsx)(a.zd,{rounding:"circle",wash:!0,children:(0,d.jsx)(a.Ee,{alt:b??"",color:"#efefef",naturalHeight:42,naturalWidth:42,src:j??""},j)})},P)})}),(0,d.jsx)(a.xu,{column:1,display:"flex",mdDisplay:"none"}),(0,d.jsxs)(a.xu,{alignItems:"center",column:12,display:"flex",justifyContent:"between",children:[(0,d.jsx)(a.xv,{size:t?"200":"300",children:(0,d.jsx)(a.rU,{href:P,onClick:this.handleClickthrough,children:f||""},P)}),!t&&this.renderFlyout()]})]}),(0,d.jsx)(a.xu,{marginBottom:t?0:1,marginTop:2,children:A&&(0,d.jsxs)(a.xu,{column:12,position:"relative",children:[C?(0,d.jsx)(ey.Z,{item:i,viewType:s}):(0,d.jsx)(ef,{item:i}),S&&(0,d.jsx)(a.xu,{bottom:!0,column:12,position:"absolute",children:this.renderPinInfoBar()})]})}),(0,d.jsxs)(a.xu,{marginStart:1,children:[w&&this.renderStatsBar(),c&&(0,d.jsx)(a.xu,{column:10,dangerouslySetInlineStyle:{__style:{whiteSpace:"pre-line"}},marginBottom:2,children:(0,d.jsx)(a.xv,{size:t?"100":"300",children:(0,d.jsx)(h,{html:c,onClick:this.handleClickHashTag})})}),!w&&(0,d.jsxs)(a.xu,{children:[z&&this.renderPinInfoBar(),this.renderStatsBar()]}),(0,d.jsx)(a.xu,{column:12,children:(0,d.jsx)(ex,{commentCount:r,creatorId:e,didItOwnerId:y,objectId:u,objectType:v.o.didIt,pinKey:{type:"deprecated",data:m},variant:"legacy"})})]}),o&&(0,d.jsx)(eb.Z,{didItData:{id:u},onDeleteConfirmation:this.handleDeleteConfirmation}),n&&(0,d.jsx)(p.ZP,{accessibilityModalLabel:this.props.i18n.bt("Users who have liked this.", "Users who have liked this.", "Label for a modal showing a list of users who have liked a Tried Item", undefined, true),allowScroll:!0,heading:(0,Q.Z)(this.props.i18n.nbt(["{{count}} like", "{{count}} likes"], l, " - ", true),{count:l.toString()}),onDismiss:this.handleToggleLikesListModal,size:"md",children:(0,d.jsx)(G.Jo,{id:u})})]})}}function eM(e){let{logContextEvent:t}=(0,x.v)(),i=(0,y.ZP)(),s=(0,L.Z)(),l=(0,o.I0)(),{reportComment:a}=(0,en.f)(),r={deleteUserDidItData:(0,n.bindActionCreators)(eA.lg,l),toggleHelpful:(0,n.bindActionCreators)(eA.YH,l),updateUserDidItDataCommentCount:(0,n.bindActionCreators)(eA.L8,l)},c=(0,o.v9)(({didItData:t})=>t[e.didItDataId]);return(0,d.jsx)(eE,{...e,...r,getHumanizedTimeSince:s,i18n:i,item:c,logContextEvent:t,reportComment:a,viewer:(0,j.Z)()})}},106874:(e,t,i)=>{i.d(t,{Jo:()=>g,Xd:()=>m});var s=i(667294),l=i(883119),o=i(144326),n=i(961754),a=i(184757),r=i(235838),d=i(383399),c=i(588537),h=i(424583),u=i(785893);function _(e,t,i){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?s:String(s))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class p extends s.Component{constructor(...e){super(...e),_(this,"setRef",e=>{e&&!this.list&&(this.list=e.parentElement,this.list&&this.list.addEventListener("scroll",this.handleScroll))}),_(this,"fetchMore",()=>{let{feedResource:e}=this.props;e.isFetching||(e.isAtEnd?window.removeEventListener("scroll",this.handleScroll):e.fetchMore())}),_(this,"handleScroll",(0,r.Z)(()=>{let{feedResource:e}=this.props;if(e.isFetching||e.isAtEnd)return;let t=(0,a.Uy)(this.list);(0,a.aZ)(this.list)-(0,a.MX)(this.list)-50<t&&this.fetchMore()},10))}componentWillUnmount(){this.list.removeEventListener("scroll",this.handleScroll)}render(){let{feedResource:{data:e,isLoaded:t},users:i,viewer:s}=this.props;if(!t)return(0,u.jsx)("div",{className:"loadingSpinner",children:(0,u.jsx)(l.$j,{accessibilityLabel:this.props.i18n.bt("Loading spinner for like list", "Loading spinner for like list", "Accessibility label for loading spinner for like list", undefined, true),show:!0})});let o=e&&e.map(e=>e.id?{...e,...i[e.id]}:e);return(0,u.jsx)(l.xu,{ref:this.setRef,"data-test-id":"liked-by-list",maxHeight:400,children:o&&o.map(e=>(0,u.jsx)(l.xu,{paddingX:4,paddingY:3,children:(0,u.jsx)(c.Z,{isSelf:!!(s.isAuth&&s.id&&e.id===s.id),user:e})},e.id))})}}function m(e){let t=(0,o.ZP)(),i=(0,d.Z)(),s=(0,h.kW)(),l=(0,n.Z)({name:"AggregatedCommentLikedByResource",options:{aggregatedCommentId:e.id},noCache:!0});return(0,u.jsx)(p,{...e,feedResource:l,i18n:t,users:s,viewer:i})}function g(e){let t=(0,o.ZP)(),i=(0,d.Z)(),s=(0,h.kW)(),l=(0,n.Z)({name:"DidItLikedByResource",options:{didItDataId:e.id},noCache:!0});return(0,u.jsx)(p,{...e,feedResource:l,i18n:t,users:s,viewer:i})}},410619:(e,t,i)=>{i.d(t,{Z:()=>u});var s=i(667294),l=i(883119),o=i(118755),n=i(144326),a=i(730212),r=i(966875),d=i(785893);function c(e,t,i){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?s:String(s))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class h extends s.Component{constructor(...e){super(...e),c(this,"state",{isFullscreen:!1,isPlaying:!1,showControls:!0,volumeLevel:0}),c(this,"handleTouch",({event:e})=>{e.stopPropagation(),this.setState(e=>({isPlaying:!e.isPlaying}))}),c(this,"handleShowControls",()=>this.setState({showControls:!0})),c(this,"handleHideControls",()=>this.setState({showControls:!1})),c(this,"handleEnded",e=>{e.event.stopPropagation(),this.setState({isPlaying:!1})}),c(this,"handlePause",({event:e})=>{e.stopPropagation(),this.setState({isPlaying:!1})}),c(this,"handlePlay",({event:e})=>{e.stopPropagation(),this.setState({isPlaying:!0})}),c(this,"handleToggleFullscreen",e=>{let{event:t,fullscreen:i}=e;t.stopPropagation(),this.setState({isFullscreen:i})}),c(this,"handleVolumeChange",({event:e,volume:t})=>{e.stopPropagation(),this.setState({volumeLevel:t})})}render(){let{item:e,requestContext:t,viewType:i}=this.props,{videos:s}=e,n=s?.[0];if(!n)return null;let{showControls:a,isFullscreen:c,isPlaying:h,volumeLevel:u}=this.state,{V_HLSV4:_}=n.video_list;if(!_)return null;let{height:p,width:m,thumbnail:g,url:x}=_||{};return(0,d.jsx)(l.iP,{dataTestId:"tried-it-video",onMouseEnter:this.handleShowControls,onMouseLeave:this.handleHideControls,onTap:this.handleTouch,rounding:2,children:(0,d.jsx)(l.zd,{rounding:2,wash:!0,willChangeTransform:!((0,o.G6)(t.userAgent.browserName)&&c),children:(0,d.jsx)(r.ZP,{aspectRatio:Math.max((m??1)/(p??1),1),captions:"",contextLogData:{view:i,viewParameter:3071,component:172,objectId:e.id,video_id:n.id},controls:a,isAutoPlay:!1,onControlsPause:this.handlePause,onControlsPlay:this.handlePlay,onEnded:this.handleEnded,onFullscreenChange:this.handleToggleFullscreen,onPlay:()=>{},onPlayError:()=>{},onVolumeChange:this.handleVolumeChange,playing:h,poster:g,src:[{type:"video/m3u8",src:x}],volume:u})})})}}function u(e){let t=(0,n.ZP)(),i=(0,a.B)();return(0,d.jsx)(h,{...e,i18n:t,requestContext:i})}},397398:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(667294),l=i(883119),o=i(144326),n=i(512541),a=i(785893);function r({entryPointRef:e,isCloseup:t=!1,isEmojiTrayOpen:i,onClick:r}){let[d,c]=(0,s.useState)(!1),h=(0,l.JZ)(),u=(0,o.ZP)(),_=(0,s.useRef)(null);(0,s.useEffect)(()=>{e&&(e.current=_.current)},[e]);let p=()=>{r?.()},m=u.bt("Select an emoji", "Select an emoji", "emojitray.button.accessibilityLabel", undefined, true);return(0,a.jsx)(l.xu,{color:i?"secondary":"transparent","data-test-id":"emoji-selector",display:"flex",justifyContent:"center",rounding:"circle",children:t?(0,a.jsx)(l.xu,{ref:_,children:(0,a.jsx)(l.hU,{accessibilityLabel:m,icon:"face-smiley",iconColor:"darkGray",onClick:p,size:"lg"})}):(0,a.jsx)(l.iP,{ref:_,accessibilityLabel:m,fullWidth:!1,onMouseEnter:()=>{c(!0)},onMouseLeave:()=>{c(!1)},onTap:p,rounding:"circle",children:(0,a.jsxs)(s.Fragment,{children:[(0,a.jsx)(n.Z,{unsafeCSS:`@keyframes wiggle {
        0% {transform: rotate(0deg);}
        25% {transform: rotate(15deg);}
        50% {transform: rotate(-15deg);}
        75% {transform: rotate(15deg);}
        100% {transform: rotate(0deg);}
      }`}),(0,a.jsx)(l.xu,{ref:e,alignItems:"center",dangerouslySetInlineStyle:{__style:d&&!h?{fontSize:"24px",animationName:"wiggle",animationDuration:"0.9s"}:{fontSize:"24px"}},display:"flex",height:40,justifyContent:"center",width:40,children:"😃"})]})})})}},953059:(e,t,i)=>{i.d(t,{Z:()=>n,k:()=>s.kH});var s=i(557085),l=i(730212),o=i(785893);let n=({dateFormatType:e,useUTC:t=!0,value:i})=>(0,o.jsx)(l.LC,{children:l=>(0,s.ZP)(l.locale,i,e,t)})},717067:(e,t,i)=>{i.d(t,{Z:()=>s});function s(e){let t=Math.round(e/1e3),i=Math.floor(t/60),s=t%60;return i+":"+(s<10?"0":"")+s}},389354:(e,t,i)=>{i.d(t,{Z:()=>o});var s=i(883119),l=i(785893);function o({accessibilityLabel:e}){return(0,l.jsx)(s.kC,{alignItems:"center",justifyContent:"center",children:(0,l.jsx)(s.$j,{accessibilityLabel:e,show:!0})})}},191851:(e,t,i)=>{i.d(t,{Z:()=>c});var s=i(667294);let l=null,o=!1,n=0,a=()=>{l&&clearTimeout(l),o=!0,l=setTimeout(()=>{o=!1},100)},r=()=>{0===n&&window.addEventListener("scroll",a),n+=1},d=()=>{(n-=1)||window.removeEventListener("scroll",a)},c=()=>{let[e,t]=(0,s.useState)(!1),i=(0,s.useRef)(null);(0,s.useEffect)(()=>(r(),()=>{i.current&&clearTimeout(i.current),d()}),[]);let l=e=>{i.current&&clearTimeout(i.current),i.current=e&&o?setTimeout(()=>l(!0),100):setTimeout(()=>{t(e)},32)};return{isHovering:e,hoverHandlers:(0,s.useRef)({onMouseOver:()=>l(!0),onMouseLeave:()=>l(!1)}).current}}},332290:(e,t,i)=>{i.d(t,{Z:()=>r});var s=i(883119),l=i(144326),o=i(785893);function n(){let e=(0,l.ZP)();return(0,o.jsx)(s.kC,{alignItems:"center",justifyContent:"center",children:(0,o.jsx)(s.$j,{accessibilityLabel:e.bt("Loading editor", "Loading editor", "EditorWithMentionsFallback.loading", undefined, true),show:!0})})}let a=(0,i(179735).Z)(()=>Promise.all([i.e(42238),i.e(89333),i.e(35585),i.e(87406)]).then(i.bind(i,618974)),void 0,"app-www-EditorWithMentions-EditorWithMentionsInternal");function r(e){return(0,o.jsx)(a,{...e,fallback:(0,o.jsx)(n,{})})}},111929:(e,t,i)=>{i.d(t,{N:()=>r,Z:()=>c});var s=i(883119),l=i(144326),o=i(240760),n=i(207630),a=i(785893);function r(e){let t=(0,l.ZP)(),{helpfulCount:i,isMarkedHelpfulByMe:n,onHelpfulClick:r}=e,d=t.bt("Helpful", "Helpful", "Comments marked helpful text.", undefined, true),c=(0,o.nk)(t.bt("Helpful {{helpfulCount}}", "Helpful {{helpfulCount}}", "Comments marked helpful count text.", undefined, true),{helpfulCount:i||0});return(0,a.jsx)(s.kC,{alignItems:"center",dataTestId:"helpful-button",justifyContent:"center",children:(0,a.jsx)(s.iP,{onTap:r,rounding:2,children:(0,a.jsxs)(s.kC,{alignItems:"center",justifyContent:"start",children:[(0,a.jsx)(s.JO,{accessibilityLabel:"helpful icon",color:n?"brandPrimary":"subtle",icon:"thumbs-up",size:16}),(0,a.jsx)(s.xu,{paddingX:1,children:(0,a.jsx)(s.xv,{color:"subtle",size:"100",weight:"bold",children:void 0!==i&&i>0?c:d})})]})})})}function d(e){let{likeCount:t,isLikedByMe:i,onLikeClick:l}=e;return(0,a.jsx)(s.kC,{alignItems:"center",justifyContent:"center",children:(0,a.jsx)(s.iP,{onTap:l,rounding:2,children:(0,a.jsxs)(s.xu,{"data-test-id":"reactions-likeWithCountButton",display:"flex",children:[(0,a.jsx)(s.JO,{accessibilityLabel:"like icon",color:i?"brandPrimary":"subtle",icon:"heart",size:16}),t>0&&(0,a.jsx)(s.xu,{"data-test-id":"reactions-likeCount",paddingX:1,children:(0,a.jsx)(s.xv,{color:"subtle",size:"100",weight:"bold",children:t})})]})})})}function c(e){let t=(0,l.ZP)(),{commentCount:i=0,reactionCounts:o={},hideReplyCount:c,isLikedByMe:h=!1,onLikeClick:u,onReplyClick:_,onReplyCountClick:p,isMarkedHelpfulByMe:m,onHelpfulClick:g,helpfulCount:x,flyout:f,small:y}=e,j=o[1]||0,v=!!i&&(0,n.Z)(t.nbt(["{{commentCount}} reply", "{{commentCount}} replies"], i, " - ", true),{commentCount:i}),b=y?1:2;return(0,a.jsxs)(s.kC,{alignItems:"center",children:[(0,a.jsxs)(s.xu,{display:"flex",marginEnd:-b,marginStart:-b,children:[(0,a.jsx)(d,{isLikedByMe:h,likeCount:j,onLikeClick:u}),(0,a.jsx)(s.xu,{paddingX:b,children:(0,a.jsx)(s.xu,{"data-test-id":"reactions-reply",children:(0,a.jsx)(s.hU,{accessibilityLabel:"Reply",bgColor:"transparent",icon:"speech",iconColor:"gray",onClick:_,size:y?"sm":"md"})})}),!!f&&(0,a.jsx)(s.xu,{paddingX:b,children:f})]}),(0,a.jsxs)(s.xu,{display:"flex",flex:"grow",justifyContent:"end",marginEnd:-3,marginStart:-3,children:[!!v&&!c&&(0,a.jsx)(s.xu,{"data-test-id":"reactions-reply-count",children:(0,a.jsx)(s.xu,{paddingX:3,children:p?(0,a.jsx)(s.iP,{dataTestId:"reactions-reply-count-tap",onTap:p,rounding:2,children:(0,a.jsx)(s.xv,{color:"subtle",size:"200",weight:"bold",children:v})}):(0,a.jsx)(s.xv,{color:"subtle",size:"200",weight:"bold",children:v})})}),(0,a.jsx)(r,{helpfulCount:x,isMarkedHelpfulByMe:m,onHelpfulClick:g})]})]})}},588537:(e,t,i)=>{i.d(t,{Z:()=>p});var s=i(667294),l=i(545007),o=i(883119),n=i(559028),a=i(144326),r=i(240760),d=i(533191),c=i(480878),h=i(402151),u=i(701918),_=i(785893);function p({isSelf:e,showVerified:t=!1,user:i={},onFollowChange:p}){let[m,g]=(0,s.useState)(i.explicitly_followed_by_me||!1),[x,f]=(0,s.useState)(!1),y=(0,l.I0)(),j=(0,a.ZP)(),v=()=>{f(!1),y((0,h.fv)(i.id)),g(!1),p&&p(i,!1)},{verified_identity:b,full_name:P,is_verified_merchant:C,is_private_profile:w,explicitly_followed_by_me:A,username:z}=i,S=b?.verified,k=i.image_medium_url||i.image_small_url;return(0,_.jsxs)(o.xu,{alignItems:"center",direction:"row",display:"flex",marginEnd:-1,marginStart:-1,paddingY:1,children:[x&&(0,_.jsx)(c.Z,{firstName:P??"",handleUnfollowUser:v,onDismiss:()=>{f(!1)}}),(0,_.jsx)(o.xu,{flex:"grow",paddingX:1,children:(0,_.jsx)(o.Tg,{href:`/${z}/`,children:(0,_.jsxs)(o.kC,{alignItems:"center",gap:{row:2,column:0},justifyContent:"start",children:[(0,_.jsx)(o.xu,{width:50,children:(0,_.jsx)(n.qE,{name:(0,r.nk)(j.bt("Avatar for {{ fullName }}", "Avatar for {{ fullName }}", "avatar.name", undefined, true),{fullName:P}).join(" "),size:"fit",src:k??""})}),(0,_.jsx)(o.xv,{weight:"bold",children:t&&(C||S)?(0,_.jsx)(u.Z,{badgeSize:"sm",badgeSpacing:2,fullName:P??"",isVerifiedIdentity:S,isVerifiedMerchant:C}):P}),w&&(0,_.jsx)(o.xu,{children:(0,_.jsx)(o.JO,{accessibilityLabel:j.bt("private icon", "private icon", "privateProfileHeaderAuthDesktop.privateIcon", undefined, true),color:"dark",icon:"lock",inline:!0})})]})})}),(0,_.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{whiteSpace:"nowrap"}},paddingX:1,children:(!w||A)&&(0,_.jsx)(d.Z,{followEventType:45,id:i.id,isFollowed:m,isUserMe:!!e,onFollow:e=>{y((0,h.ZN)(e)),g(!0),p&&p(i,!0)},onUnfollow:()=>{w?f(!0):v()},pinKey:null,textType:"FollowUnfollow",unfollowEventType:46,viewType:4})})]})}},423057:(e,t,i)=>{i.r(t),i.d(t,{default:()=>h});var s=i(883119),l=i(758339),o=i(144326),n=i(240760),a=i(635258),r=i(410150),d=i(785893);let c=a.K_Y+"?source=block_dialogue";function h({firstName:e,onBlockUser:t,onClearModal:i}){let a=(0,o.ZP)(),h=(0,r.HG)(),u=(0,n.nk)(a.bt("Block {{ firstName }}?", "Block {{ firstName }}?", "blockUser.modal.header", undefined, true),{firstName:e}).join(""),_=(0,n.nk)(a.bt("Blocking {{ firstName }} stops messages, follows and comments. You can still view each other’s profiles.", "Blocking {{ firstName }}, stops messages, follows, and comments. You can still view each other’s profiles.", "blockUser.modal.description", undefined, true),{firstName:e});return h?(0,d.jsxs)(l.ZP,{accessibilityModalLabel:u,footer:(0,d.jsxs)(s.xu,{alignItems:"center",display:"flex",justifyContent:"end",marginEnd:-1,marginStart:-1,children:[(0,d.jsx)(s.xu,{padding:1,children:(0,d.jsx)(s.zx,{fullWidth:!0,onClick:i,size:"lg",text:a.bt("Cancel", "Cancel", "blockUser.modal.cancel", undefined, true)})}),(0,d.jsx)(s.xu,{padding:1,children:(0,d.jsx)(s.zx,{color:"red",fullWidth:!0,onClick:t,size:"lg",text:a.bt("Block", "Block", "Button to confirm blocking a user", undefined, true)})})]}),heading:u,onDismiss:i,role:"alertdialog",size:"md",children:[(0,d.jsx)(s.xu,{"data-test-id":"block-text",marginEnd:6,marginStart:6,children:(0,d.jsx)(s.xv,{children:_})}),(0,d.jsx)(s.xu,{marginEnd:6,marginStart:6,marginTop:4,children:(0,d.jsx)(s.xv,{color:"default",weight:"bold",children:(0,d.jsx)(s.rU,{href:c,target:"blank",children:a.bt("Learn more", "Learn more", "link to help center to learn more about blocking", undefined, true)})})})]}):(0,d.jsxs)(l.ZP,{accessibilityModalLabel:u,mobileHideCloseIcon:!0,onDismiss:i,type:"block_button",children:[(0,d.jsx)(s.xu,{alignItems:"center",display:"flex",paddingX:3,paddingY:5,children:(0,d.jsx)(s.X6,{accessibilityLevel:1,size:"500",children:u})}),(0,d.jsx)(s.xu,{marginBottom:4,marginEnd:4,marginStart:4,children:(0,d.jsx)(s.xv,{children:_})}),(0,d.jsxs)(s.xu,{alignItems:"center",display:"flex",justifyContent:"center",marginBottom:8,children:[(0,d.jsx)(s.xu,{padding:1,children:(0,d.jsx)(s.zx,{fullWidth:!0,onClick:i,size:"md",text:a.bt("Cancel", "Cancel", "blockUser.modal.cancel", undefined, true)})}),(0,d.jsx)(s.xu,{padding:1,children:(0,d.jsx)(s.zx,{color:"red",fullWidth:!0,onClick:t,size:"md",text:a.bt("Block", "Block", "Button to confirm blocking a user", undefined, true)})})]})]})}},480878:(e,t,i)=>{i.d(t,{Z:()=>d});var s=i(883119),l=i(758339),o=i(144326),n=i(240760),a=i(410150),r=i(785893);function d({onDismiss:e,firstName:t,handleUnfollowUser:i}){let d=(0,o.ZP)(),c=(0,a.HG)(),h=(0,n.nk)(d.bt("Unfollow {{ firstName }}?", "Unfollow {{ firstName }}?", "unfollowUser.modal.header", undefined, true),{firstName:t}).join(""),u=d.bt("You will no longer be able to view their profile, Pins, boards, followers or following lists. They will not be notified.", "You will no longer be able to view their profile, Pins, boards, followers or following lists. They will not be notified.", "unFollowUser.modal.description", undefined, true),_=d.bt("Cancel", "Cancel", "unfollowUser.modal.cancel", undefined, true),p=d.bt("Unfollow", "Unfollow", "unfollowUser.modal.button.unfollow", undefined, true);return c?(0,r.jsx)(l.ZP,{accessibilityModalLabel:h,footer:(0,r.jsxs)(s.xu,{alignItems:"center",display:"flex",justifyContent:"end",marginEnd:-1,marginStart:-1,children:[(0,r.jsx)(s.xu,{padding:1,children:(0,r.jsx)(s.zx,{fullWidth:!0,onClick:e,size:"lg",text:_})}),(0,r.jsx)(s.xu,{padding:1,children:(0,r.jsx)(s.zx,{color:"red",fullWidth:!0,onClick:i,size:"lg",text:p})})]}),heading:h,onDismiss:e,role:"alertdialog",size:"md",children:(0,r.jsx)(s.xu,{"data-test-id":"unfollow-text",marginEnd:6,marginStart:6,children:(0,r.jsx)(s.xv,{children:u})})}):(0,r.jsxs)(l.ZP,{accessibilityModalLabel:h,mobileHideCloseIcon:!0,onDismiss:e,type:"unFollow_button",children:[(0,r.jsx)(s.xu,{alignItems:"center",display:"flex",paddingX:3,paddingY:5,children:(0,r.jsx)(s.X6,{accessibilityLevel:1,size:"500",children:h})}),(0,r.jsx)(s.xu,{marginBottom:4,marginEnd:4,marginStart:4,children:(0,r.jsx)(s.xv,{children:u})}),(0,r.jsxs)(s.xu,{alignItems:"center",display:"flex",justifyContent:"center",marginBottom:8,children:[(0,r.jsx)(s.xu,{padding:1,children:(0,r.jsx)(s.zx,{fullWidth:!0,onClick:e,size:"md",text:_})}),(0,r.jsx)(s.xu,{padding:1,children:(0,r.jsx)(s.zx,{color:"red",fullWidth:!0,onClick:i,size:"md",text:p})})]})]})}},43688:(e,t,i)=>{function s(e,t){return e?t.bt("Title too long. Make sure all card titles have fewer than 100 characters", "Title too long. Make sure all cards' titles have less than 100 characters", "Title entered is too long while editing a carousel pin and/or one of its pins", undefined, true):t.bt("Title too long. Make sure title has fewer than 100 characters", "Title too long. Make sure title has less than 100 characters", "Title entered is too long while editing a pin", undefined, true)}function l(e,t){return e?t.bt("Description too long. Make sure all card descriptions have fewer than 500 characters", "Description too long. Make sure all cards' descriptions have less than 500 characters", "Description entered is too long while editing a carousel pin and/or one of its pins", undefined, true):t.bt("Description too long. Make sure description has fewer than 500 characters", "Description too long. Make sure description has less than 500 characters", "Description entered is too long while editing a pin", undefined, true)}function o(e,t){return t.bt("Too many mentions. Make sure you have no more than 5.", "Too many mentions. Make sure you have at most 5.", "editPinModal.errorMessages.userMentionOverLimit", undefined, true)}function n(e,t){return e?t.bt("Need to provide a valid URL. Make sure all card links are valid", "Need to provide a valid URL. Make sure all cards' links are valid", "Invalid URL/link provided while editing a carousel pin and/or one of its pins", undefined, true):t.bt("Need to provide a valid URL. Make sure the link is valid", "Need to provide a valid URL. Make sure the link is valid", "Invalid URL/link provided while editing a pin", undefined, true)}i.d(t,{MM:()=>l,Y8:()=>s,bl:()=>o,qj:()=>n})},686993:(e,t,i)=>{i.d(t,{Z:()=>p});var s=i(667294),l=i(883119),o=i(400416),n=i(357013),a=i(144326),r=i(240760),d=i(611735),c=i(639686),h=i(785893);function u(e,t,i){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?s:String(s))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class _ extends s.Component{constructor(...e){super(...e),u(this,"state",{recommendations:[],selectedIndex:0,resourceLoaded:!1}),u(this,"onDismiss",()=>{}),u(this,"mounted",!1),u(this,"addHashtag",e=>{this.props.addHashtag(e),this.setState({recommendations:[]})}),u(this,"handleKeyDown",e=>{e.keyCode===d.Z.UP?this.handlePrevHashtag(e):e.keyCode===d.Z.DOWN?this.handleNextHashtag(e):e.keyCode===d.Z.ESCAPE?this.handleClose(e):e.keyCode===d.Z.ENTER&&this.handleSubmit(e)}),u(this,"handlePrevHashtag",e=>{e.preventDefault(),this.state.selectedIndex>0&&this.setState(e=>({selectedIndex:e.selectedIndex-1}))}),u(this,"handleNextHashtag",e=>{e.preventDefault(),this.state.selectedIndex<this.state.recommendations.length-1&&this.setState(e=>({selectedIndex:e.selectedIndex+1}))}),u(this,"handleClose",e=>{e.preventDefault(),this.setState({recommendations:[]})}),u(this,"handleSubmit",e=>{e.preventDefault(),this.addHashtag(this.state.recommendations[this.state.selectedIndex].query)}),u(this,"callResource",e=>{let{makeCancelablePromise:t}=this.props;t((0,o.Z)({url:"/v3/search/autocomplete/",data:{q:e,show_pin_count:!0}}),"typeahead").then(e=>{if(!this.mounted)return;let{data:t}=e.resource_response;this.setState({recommendations:t.slice(0,5),resourceLoaded:!0})}).catch(({isCanceled:e})=>{e||this.setState({resourceLoaded:!1})})})}componentDidMount(){this.mounted=!0,this.callResource(this.props.query),window.addEventListener("keydown",this.handleKeyDown)}componentDidUpdate(e){this.props.query!==e.query&&""!==this.props.query&&this.callResource(this.props.query)}componentWillUnmount(){window.removeEventListener("keydown",this.handleKeyDown),this.mounted=!1}render(){let{recommendations:e,resourceLoaded:t,selectedIndex:i}=this.state,{anchor:s,idealDirection:o}=this.props,a=e.filter(e=>e.query),d="flyout_"+a.length;return t&&a.length>0?(0,h.jsx)(l.J2,{anchor:s,idealDirection:o||"down",onDismiss:this.onDismiss,size:"sm",children:(0,h.jsx)(l.xu,{width:"100%",zIndex:new l.Ry(3),children:a.length>0?a.map((e,t)=>(0,h.jsx)(l.iP,{fullWidth:!1,onTap:()=>this.addHashtag(e.query),children:(0,h.jsxs)(l.xu,{alignItems:"center",color:t===i?"secondary":"transparent",display:"flex",justifyContent:"between",padding:1,children:[(0,h.jsx)(l.xu,{flex:"grow",children:(0,h.jsx)(l.xv,{inline:!0,size:"200",weight:"bold",children:e.query})}),(0,h.jsx)(l.xu,{flex:"none",children:(0,h.jsx)(l.xv,{inline:!0,size:"100",children:(0,r.nk)(this.props.i18n.nbt(["{{ count }} Pin", "{{ count }} Pins"], Number(e.pin_count), "label for n pins in hashtag flyout", true),{count:(0,h.jsx)(n.Z,{value:Number(e.pin_count)},"pinCount")})})})]})},e.query)):null})},d):null}}function p(e){let t=(0,a.ZP)(),i=(0,c.Z)();return(0,h.jsx)(_,{...e,i18n:t,makeCancelablePromise:i})}},983284:(e,t,i)=>{i.d(t,{d:()=>s});let s={BOARD:"board",PIN:"pin",DID_IT:"did_it",PINNER:"pinner",USER:"user",TODAY_ARTICLE:"today_article",FOLLOW_INVITE:"follow_invite"}},656440:(e,t,i)=>{i.d(t,{Z:()=>c});var s=i(545007),l=i(883119),o=i(144326),n=i(240760),a=i(66560),r=i(424583),d=i(785893);function c({triedItId:e}){let t=(0,o.ZP)(),i=(0,s.v9)(({triedits:t})=>t[e]),c=(0,r.mN)()(i.user??""),h=(0,a.S6)()(i.pin??"");return h&&c?(0,d.jsxs)(l.xu,{children:[(0,d.jsxs)(l.xu,{alignItems:"center",column:12,display:"flex",children:[(0,d.jsx)(l.sg,{span:2,children:(0,d.jsx)(l.xu,{marginEnd:1,children:(0,d.jsx)(l.HE,{accessibilityLabel:t.bt("User's avatar", "User`s avatar", "User`s avatar", undefined, true),collaborators:[{name:c.full_name??"",src:c.image_medium_url||c.image_large_url||void 0}],href:`/${encodeURIComponent(c.username)}/`,role:"link"})})}),(0,d.jsx)(l.sg,{span:2,children:(0,d.jsx)(l.xu,{marginEnd:2,children:(0,d.jsx)(l.Tg,{href:`/pin/${h.id}/`,rounding:2,tapStyle:"none",children:(0,d.jsx)(l.zd,{rounding:2,wash:!0,children:(0,d.jsx)(l.Ee,{alt:h.description||"",color:"#767676",naturalHeight:136,naturalWidth:136,src:h.images?.["136x136"]?.url??""})})})})}),(0,d.jsx)(l.sg,{span:8,children:(0,d.jsx)(l.xv,{size:"200",weight:"bold",children:(0,d.jsx)(l.rU,{href:`/pin/${h.id}/`,tapStyle:"none",children:(0,n.nk)(t.bt("{{ name }} tried this Pin", "{{ name }} tried this Pin", " - ", undefined, true),{name:c.full_name})})})})]}),i?.images?.[0]?.["550x"]&&(0,d.jsx)(l.xu,{marginTop:2,children:(0,d.jsx)(l.zd,{rounding:2,children:(0,d.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:{paddingBottom:"100%"}},position:"relative",children:(0,d.jsx)(l.xu,{bottom:!0,left:!0,position:"absolute",right:!0,top:!0,children:(0,d.jsx)(l.Ee,{alt:i.details??"",color:"#767676",fit:"cover",naturalHeight:1,naturalWidth:1,src:i.images[0]["550x"].url||""})})})})}),(0,d.jsxs)(l.xu,{column:10,marginTop:2,children:[!!i?.like_count&&i.like_count>0&&(0,d.jsx)(l.xu,{paddingY:1,children:(0,d.jsx)(l.xv,{color:"subtle",inline:!0,size:"100",children:(0,d.jsx)(l.rU,{display:"inlineBlock",href:`/tried_it/${encodeURIComponent(i.id??"")}/likes/`,rounding:2,underline:"hover",children:(0,n.nk)(t.nbt(["{{ count }} person likes this", "{{ count }} people like this"], i.like_count ?? 0, "person or people liking a given tried it", true),{count:i.like_count})})})}),(0,d.jsx)(l.xv,{children:i?.details})]})]}):null}},762577:(e,t,i)=>{i.d(t,{X:()=>c,f:()=>d});var s=i(667294),l=i(498490),o=i(891985);function n(e=null,t){switch(t.type){case"REPORT_CONTENT_SHOW":return{id:t.payload.id,auxData:t.payload.auxData,isProduct:t.payload.isProduct,isPromoted:t.payload.isPromoted,parentId:t.payload.parentId,videoDuration:t.payload.videoDuration,viewParameter:t.payload.viewParameter,viewType:t.payload.viewType,type:t.payload.type,isThirdPartyAd:t.payload.isThirdPartyAd,nodeId:t.payload.nodeId};case"REPORT_CONTENT_DISMISS":return null;default:return e}}var a=i(785893);let{Provider:r,useHook:d}=(0,l.Z)("ReportData");function c({children:e}){let[t,i]=(0,s.useReducer)(n,null),l=(0,s.useCallback)(()=>i({type:"REPORT_CONTENT_DISMISS"}),[]),d=(0,s.useCallback)((e,t,s)=>i({type:"REPORT_CONTENT_SHOW",payload:{id:e,isProduct:!1,isPromoted:!1,parentId:t,videoDuration:null,viewParameter:null,viewType:null,type:s,nodeId:null}}),[]),c=(0,s.useCallback)((e,t,s)=>i({type:"REPORT_CONTENT_SHOW",payload:{id:e,isProduct:!1,isPromoted:!1,videoDuration:null,viewParameter:t,viewType:s,type:"conversation",nodeId:null}}),[]),h=(0,s.useCallback)(({id:e,viewParameter:t,viewType:s,nodeId:l})=>i({type:"REPORT_CONTENT_SHOW",payload:{id:e,isProduct:!1,isPromoted:!1,videoDuration:null,viewParameter:t,viewType:s,type:"pin",nodeId:l}}),[]),u=(0,s.useCallback)(({pinId:e,isDownstreamPromotion:t,hasPromoter:s,firstVideoDuration:l,isProduct:n,viewParameter:a,viewType:r,isThirdPartyAd:d,nodeId:c,auxData:h})=>{i({type:"REPORT_CONTENT_SHOW",payload:{id:e,auxData:h,isProduct:n,isPromoted:(0,o.jL)(t,s),videoDuration:l,viewParameter:a,viewType:r,type:"pin",isThirdPartyAd:d,nodeId:c}})},[]),_=(0,s.useMemo)(()=>({reportData:t,dismiss:l,reportComment:d,reportConversation:c,reportImage:h,reportPin:u}),[t,l,d,c,h,u]);return(0,a.jsx)(r,{value:_,children:e})}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/33656.en_IN-02343e0fdd99a4f4.mjs.map